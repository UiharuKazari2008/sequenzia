- let enableManageTools = false
- let enableUploadTools = false
- full_title_post = full_title
doctype html
if (write_channels && write_channels.length > 0)
    - enableUploadTools = true
    //- /channel=([^&]+)/.exec(req_uri)[1].split("+").forEach((ch) => { if (write_channels.indexOf(ch) !== -1 ){ enableUploadTools = true }})
if (manage_channels && manage_channels.length > 0)
    - enableManageTools = true
if (req_uri)
    - params = new URLSearchParams(req_uri.split('?')[1])
    - path = '/' + req_uri.split('?')[0].split('/').pop()
if (results && (params && (path === '/gallery' || path === '/files' || path === '/cards')))
    - let search_uri = `/gallery`;
    - if (req_uri) { search_uri = req_uri }
else
    - let search_uri = `/files`;

html
    head
        if (appData)
            title= `${webconf.site_name} - ${full_title}`
        else if (results && results.length > 0)
            if (full_title && params.has('displayname') && params.getAll('displayname')[0] !== '*')
                - _display_nice_name = results[0].history.name
                if (full_title.split(' / ').pop().toLowerCase().trim() !== _display_nice_name.toLowerCase().trim())
                    - full_title_post = full_title.split(' / ').reverse().splice(1).reverse().join(' / ') + ' / ' + _display_nice_name
            meta(name='result', content=0)
            if (!title || title === '')
                if (params && (params.getAll('channel')[0] === 'random' || !(params.has('channel') || params.has('folder') || params.has('album') || params.has('album_name'))) || params.getAll('sort')[0] === 'random')
                    if (results && results.length === 1)
                        title= `${webconf.site_name} - Item Details`
                    else if (tags_prev)
                        title= `${webconf.site_name} - Tags`
                    else if (search_prev)
                        if (params && path === '/artists')
                            title= `${webconf.site_name} - Artist Search`
                        else if (params && search_prev.startsWith('id:st'))
                            title= `${webconf.site_name} - Related Items`
                        else
                            title= `${webconf.site_name} - Search`
                    else if (params && path === '/artists')
                        title= `${webconf.site_name} - Artists`
                    else if (params && params.getAll('sort')[0] === 'random')
                        title= `${webconf.site_name} - I'm Feeling Lucky`
                    else if (params.has('color'))
                        title= `${webconf.site_name} - Colour Search`
                    else if (params.has('displayname'))
                        title= `${webconf.site_name} - History`
                    else if (params && (params.getAll('sort')[0] === 'id' || params.getAll('sort')[0] === 'eid') && path === '/files')
                        title= `${webconf.site_name} - Latest Files`
                    else if (params && (params.getAll('sort')[0] === 'id' || params.getAll('sort')[0] === 'eid'))
                        title= `${webconf.site_name} - Latest Media`
                    else if (params && (params.getAll('sort')[0] === 'rating'))
                        title= `${webconf.site_name} - MIITS Score`
                    else if (path === '/tvTheater' || path === '/listTheater')
                        title= `${webconf.site_name} - Theater`
                    else
                        title= `${webconf.site_name} - Recent`
                else
                    title=`${webconf.site_name}`

            else
                title= `${webconf.site_name} - ${full_title_post}`
        else if (randomImage)
            meta(name='result', content=0)
            title=`${webconf.site_name}`
        else
            meta(name='result', content=10)
            title= `${webconf.site_name} - No Results`

    body(id="page-top" class=showSidebar1)
        script.
            if (performaceMode) {
                document.querySelector('body').classList.add('performance-mode');
                console.log('Performance Mode is enabled, No animation will be enabled and all effects are removed')
            }
        if (!(params.has('responseType') && params.getAll('responseType')[0] === 'offline'))
            div.background-image.overlay
            div.background-image.bg-blur

        div(id="wrapper")
            div(id="content-wrapper", class="d-flex flex-column")
                div(id="content")
                    if (params.has('ratio'))
                        - ratioValues = params.getAll('ratio')[0].split('-')
                        if (ratioValues.length > 1)
                            - sliderDefaults = `[${ratioValues[0]},${ratioValues[1]}]`
                        else
                            - sliderDefaults = '[0,3]'
                    else
                        - sliderDefaults = '[0,3]'
                    if (params.has('color'))
                        - colorsRGB = params.getAll('color')[0].split('%3A')
                        if (colorsRGB.length >= 3)
                            - colorRValue = colorsRGB[0].split('-');
                            - colorGValue = colorsRGB[1].split('-');
                            - colorBValue = colorsRGB[2].split('-');
                            if (colorRValue.length === 2 && colorGValue.length === 2 && colorBValue.length === 2)
                                - sliderColorsDefaults = [`[${colorRValue[0]},${colorRValue[1]}]`, `[${colorGValue[0]},${colorGValue[1]}]`, `[${colorBValue[0]},${colorBValue[1]}]`]
                            else if (colorRValue.length === 1 && colorGValue.length === 1 && colorBValue.length === 1)
                                if (colorsRGB.length >= 4)
                                    - colorStep = parseInt(colorsRGB[3]);
                                if (isNaN(colorStep))
                                    - colorStep = 16
                                - sliderColorsDefaults = [`[${parseInt(colorRValue[0]) - colorStep},${parseInt(colorRValue[0]) + colorStep}]`,`[${parseInt(colorGValue[0]) - colorStep},${parseInt(colorGValue[0]) + colorStep}]`,`[${parseInt(colorBValue[0]) - colorStep},${parseInt(colorBValue[0]) + colorStep}]`,]
                                - simularColor = `rgb(${colorRValue[0]}, ${colorGValue[0]}, ${colorBValue[0]})`
                                - simularColorCommand = `${colorRValue[0]}:${colorGValue[0]}:${colorBValue[0]}`
                            else
                                - sliderColorsDefaults = ['[0,255]', '[0,255]', '[0,255]']
                        else
                            - sliderColorsDefaults = ['[0,255]', '[0,255]', '[0,255]']
                    else
                        - sliderColorsDefaults = ['[0,255]', '[0,255]', '[0,255]']
                    div#mainMenuBar.top-padding-safety(class=(nsfwEnabled || nsfwContent || (params && params.getAll('nsfw')[0] === 'true')) ? 'menu-nsfw' : '')
                        div#topBarPWA
                        div#userMenu.collapsed.collapse
                            div.shown-user-menu.d-flex(style="width: 100%; height: 100%").user-menu-buttons
                                div#menuAccordion.w-100
                                    div.main-menu-items.w-100(class=`collapse ${(appData || (path && (path === '/tvTheater' || path === '/listTheater'))) ? '' : 'show'}` data-parent="#menuAccordion" id=`menuItemMain${(appData || (path && (path === '/tvTheater' || path === '/listTheater'))) ? 'Seq' : ''}`).animated--grow-in
                                        div.user-info-bg.rounded
                                            div.user-info-backdrop.rounded
                                            div.user-info-border.rounded
                                            div.user-info-overlay.position-absolute.rounded
                                            div.user-infocard-holder.d-flex.flex-column
                                                .row.p-0.m-2(style="padding: 0.25em 0.5em;")
                                                    img.sidebar-brand-logo.sequenzia-logo.shadow(src='/static/img/sequenzia-logo-nav.png' style='height: 28px; filter: drop-shadow(0px 0px 2px black);')
                                                    if (discord.user.membership)
                                                        if (discord.user.membership.background)
                                                            div.badge.ml-auto.d-flex.align-items-center.justify-content-center(style=`font-size: 1em; ${(discord.user.membership.color) ? 'color: ' + discord.user.membership.color + '; ' : ''}background: ${discord.user.membership.background}`)
                                                                if (discord.user.membership.icon)
                                                                    i.fas.pr-2(class=`fa-${discord.user.membership.icon}`)
                                                                span(style="z-index: 1;") #{discord.user.membership.text}
                                                        else
                                                            div.ml-auto.d-flex.align-items-center.justify-content-center(style=`${(discord.user.membership.color) ? 'color: ' + discord.user.membership.color + '; ' : ''}`)
                                                                if (discord.user.membership.icon)
                                                                    i.fas.pr-2(class=`fa-${discord.user.membership.icon}`)
                                                                span(style="z-index: 1;") #{discord.user.membership.text}
                                                    else
                                                        span.ml-auto.shadow-text(style="z-index: 1;") Member


                                                .row.p-0.user-infocard-row1(style='width: calc(100% - 1.125em);')
                                                    .col-auto.p-0
                                                        img.rounded-circle.user-infocard-icon(src=user.avatar)
                                                    .col.p-0.pl-2.text-ellipsis.d-flex.mt-auto.flex-column
                                                        div.text-center.text-ellipsis.align-middle.mr-auto
                                                            if (login_source && login_source === 900)
                                                                span.badge.font-weight-bold.text-uppercase.badge-danger Insecure Login Method
                                                            else if (discord && discord.user && discord.user.server && discord.user.server.length > 0)
                                                                i.pr-1.fas.fa-check-circle
                                                                span #{(discord.user.server[0].nice_name) ? discord.user.server[0].nice_name : discord.user.server[0].name}
                                                                //img.server-icon.rounded-circle(title=`${thisServer.name}\n(${(thisServer.login === 1) ? 'Login Server' : 'Storage'})` src=thisServer.icon id=`server-${thisServer.serverid}`)
                                                        div.text-ellipsis.shadow-text.user-infocard-info
                                                            span.p-0.font-weight-light.d-inline.user-infocard-username #{user.username}
                                        if (next_episode)
                                            div.outer-menu-next-episode(style='margin: calc(env(safe-area-inset-top,0) + .75em) 0 .75em .75em;' onclick=`getNewContent([],[["show_id","${next_episode.show_id}"]${(next_episode.nsfw === 1) ? ',["nsfw","true"]' : ''}${(!next_episode.data.seasons) ? ',["sort","name"]' : ''}],'/listTheater')`)
                                                img.border-left-warning.rounded.kongou-next-episode-image(style="height: 152px" src=`${(next_episode.poster) ? 'https://media.discordapp.net/attachments' + next_episode.poster : next_episode.data.poster[0]}`)
                                        div.position-relative.user-menu-height(style="width: 100%;" class=`${((search_prev && search_prev !== '')) ? 'dual-search' : ''}`)
                                            .row.w-100.ml-0.mr-0
                                                .col-auto.p-0
                                                    if (appData || (path && (path === '/tvTheater' || path === '/listTheater')))
                                                        a(title="Return to Application Menu" class="btn btn-primary collapsed" data-toggle="collapse" data-target="#menuItemMain").mr-1
                                                            i.far.fa-fw.fa-browser
                                                .col.p-0
                                                    div#locationAccordion.w-100
                                                        div#locationSearch(class=`collapse ${((search_prev && search_prev !== '')) ? 'show' : ''}` data-parent="#locationAccordion")
                                                            form.col.form-inline.navbar-search.top-menu-search-bar(onsubmit="return false;" method="post" style="width: 100%;" )
                                                                .input-group.w-100.flex-nowrap
                                                                    .input-group-prepend.flex-column.flex-sm-row.justify-content-center
                                                                        a.btn.input-group-text.bg-transparent.border-0.pl-0(title="Enter Direct URI Mode" href='#_' class="collapsed" data-toggle="collapse" data-target="#locationDirect" onclick='showAddressInput(); return false;')
                                                                            i.far.fa-map.align-middle
                                                                        a.btn.input-group-text.bg-transparent.border-0.pl-0(title="Search Tags" href='#_' class="collapsed" data-toggle="collapse" data-target="#locationTags" onclick="$('#menuItemMain .user-menu-height').removeClass('dual-search'); return false;")
                                                                            i.far.fa-chevron-up.align-middle
                                                                    div.d-flex.flex-column.w-100.justify-content-between.flex-md-row
                                                                        div.w-100.d-flex.flex-row.justify-content-between.align-items-center.position-relative
                                                                            input#dropdownSearch4.form-control.top-menu-search-bar.border-0.w-100.p-0(type='text' placeholder='Tags' aria-label='Tags' aria-describedby='basic-addon2' name="searchtags" value=tags_prev)
                                                                            i.far.fa-tags.position-absolute.pr-3(style="opacity: 50%; right: 0;")
                                                                        div.w-100.d-flex.flex-row.justify-content-between.align-items-center.position-relative
                                                                            input#dropdownSearch2.form-control.top-menu-search-bar.border-0.w-100.p-0(type='text' placeholder='SDQ' aria-label='Search' aria-describedby='basic-addon2' name="searchterm" value=search_prev)
                                                                            i.far.fa-search.position-absolute.pr-3(style="opacity: 50%; right: 0;")
                                                                    input(type="submit" style="display: none" onclick=`getSearchContent("dropdownSearch2", "dropdownSearch4"); return false;`)
                                                                    .input-group-append
                                                                        a.btn.input-group-text.bg-transparent.border-0.pl-0(title="Search Help" href='#_' data-toggle='modal' data-target='#searchHelpModal').d-none.d-sm-flex
                                                                            i.far.fa-question-circle.align-middle
                                                                        a.btn.input-group-text.top-menu-search-bar.border-0(title="Search Current Results"  href='#_', onclick=`getSearchContent("dropdownSearch2", "dropdownSearch4"); return false;`)
                                                                            i.far.fa-square-arrow-right.fa-sm.align-middle.nav-item
                                                                        a.btn.input-group-text.top-menu-search-bar.border-0(title="Search for Images"  href='#_', onclick=`getSearchContent("dropdownSearch2", "dropdownSearch4", "/gallery"); return false;`)
                                                                            i.far.fa-image.fa-sm.align-middle.nav-item
                                                                        a.btn.input-group-text.top-menu-search-bar.border-0(title="Search for Files" href='#_', onclick=`getSearchContent("dropdownSearch2", "dropdownSearch4", "/files"); return false;`)
                                                                            i.far.fa-folder.fa-sm.align-middle.nav-item
                                                        div#locationTags(class=`collapse ${!(search_prev && search_prev !== '') ? 'show' : ''}` data-parent="#locationAccordion")
                                                            form.col.form-inline.navbar-search.top-menu-search-bar(onsubmit="return false;" method="post" style="width: 100%;" )
                                                                .input-group.w-100.flex-nowrap
                                                                    .input-group-prepend
                                                                        a.btn.input-group-text.bg-transparent.border-0.pl-0(title="Enter Direct URI Mode" href='#_' class="collapsed" data-toggle="collapse" data-target="#locationDirect" onclick='showAddressInput(); return false;')
                                                                            i.far.fa-map.align-middle
                                                                        a.btn.input-group-text.bg-transparent.border-0.pl-0(title="Generic Search" href='#_' class="collapsed" data-toggle="collapse" data-target="#locationSearch" onclick="$('#menuItemMain .user-menu-height').addClass('dual-search'); return false;")
                                                                            i.far.fa-chevron-down.align-middle
                                                                    div.w-100.d-flex.flex-row.justify-content-between.align-items-center.position-relative
                                                                        input#dropdownSearch3.form-control.top-menu-search-bar.border-0.w-100.p-0(type='text' placeholder='Tags' aria-label='Tags' aria-describedby='basic-addon2' name="searchtags" value=tags_prev)
                                                                        i.far.fa-tags.position-absolute.pr-3(style="opacity: 50%; right: 0;")
                                                                    input(type="submit" style="display: none" onclick=`getSearchContent("dropdownSearch2", "dropdownSearch3"); return false;`)
                                                                    .input-group-append
                                                                        a.btn.input-group-text.bg-transparent.border-0.pl-0(title="Search Help" href='#_' data-toggle='modal' data-target='#searchHelp2Modal')
                                                                            i.far.fa-question-circle.align-middle
                                                                        a.btn.input-group-text.top-menu-search-bar.border-0(title="Search Current Results"  href='#_', onclick=`getSearchContent("dropdownSearch2", "dropdownSearch3"); return false;`)
                                                                            i.far.fa-square-arrow-right.fa-sm.align-middle.nav-item.input-group-append
                                                                        a.btn.input-group-text.top-menu-search-bar.border-0(title="Search Everywhere"  href='#_', onclick=`getSearchContent("dropdownSearch2", "dropdownSearch3", "/gallery"); return false;`)
                                                                            i.far.fa-globe.fa-sm.align-middle.nav-item.input-group-append
                                                        div#locationDirect(class="collapse" data-parent="#locationAccordion")
                                                            form.col.form-inline.navbar-search.top-menu-search-bar(onsubmit="return false;" method="post" style="width: 100%;" )
                                                                .input-group.w-100
                                                                    .input-group-prepend
                                                                        a.btn.input-group-text.bg-transparent.border-0.pl-0(title="Search Tags" href='#_' class="collapsed" data-toggle="collapse" data-target="#locationTags" onclick='hideAddressInput(); $(\'#menuItemMain .user-menu-height\').removeClass(\'dual-search\'); return false;')
                                                                            i.far.fa-search.align-middle
                                                                    input#directURI.text-white.form-control.top-menu-search-bar.border-0(type='text' placeholder='Go to Location' aria-label='Go to Location')
                                                                    input(type="submit" style="display: none" onclick=`getNewURIContent("directURI"); return false;`)
                                                                    .input-group-append
                                                                        a.btn.input-group-text.top-menu-search-bar.border-0(title="Go to..." href='#_', onclick=`getNewURIContent("directURI"); return false;`)
                                                                            i.far.fa-arrow-right.fa-sm.align-middle.nav-item
                                                    //span.col-auto.sidebar-brand-logo.sequenzia-logo.user-menu-icon.ml-lg-1.p-0.d-none.d-lg-block sequenzia
                                            .row.w-100.position-absolute.pb-3.ml-0.mr-0(style='bottom: 0; left: 0;').d-flex.justify-content-center
                                                .menu-grid
                                                    //if (appData || (path && (path === '/tvTheater' || path === '/listTheater')))
                                                        a.user-menu-item(title="Return to Sequenzia Menu" href='#_' class="collapsed" data-toggle="collapse" data-target="#menuItemMain")
                                                            i.fa-light.fa-fw.fa-browser
                                                            | App Menu
                                                    a.user-menu-item(class=`user-menu-overlow-icon-1${(next_episode) ? '-nep' : ''}` title="Return to Homescreen" href='/')
                                                        i.fa-light.fa-fw.fa-home
                                                        | Home
                                                    a.user-menu-item(title="Browse Folders" href='#_' role='button' accesskey="," onclick="$(document).scrollTop(0); toggleMenu();")
                                                        i.fa-light.fa-compass.fa-fw
                                                        | Directory
                                                    a.user-menu-item(title="Recently Uploaded Media" href='#/gallery?numdays=60&sort=eid')
                                                        i.fa-light.fa-fw.fa-photo-video
                                                        | Gallery
                                                    a.user-menu-item(title="Recently Uploaded Files" href=`#/files?numdays=60&sort=eid&filesonly=true`)
                                                        i.fa-light.fa-fw.fa-files
                                                        | Files
                                                    a.user-menu-item(title="Theaters" href='#_' class="collapsed" data-toggle="collapse" data-target=`#${(path && (path === '/tvTheater' || path === '/listTheater')) ? 'menuItemMain' : 'menuItemTheater'}`)
                                                        i.fa-light.fa-fw.fa-ticket
                                                        | Theater
                                                    a.user-menu-item(title="Your Favorites" href='#/gallery?sort=fav&pins=true')
                                                        i.fa-light.fa-fw.fa-star
                                                        | Favorites
                                                    a.user-menu-item(title="Albums" href='#_' class="collapsed" data-toggle="collapse" data-target="#menuItemAlbums")
                                                        i.fa-light.fa-fw.fa-archive
                                                        | Albums
                                                    if (artists && artists.length > 0)
                                                        a.user-menu-item(title="Artists" href='#_' class="collapsed" data-toggle="collapse" data-target="#menuItemArtists")
                                                            i.fa-light.fa-fw.fa-address-book
                                                            | Artists
                                                    else
                                                        a.user-menu-item(title="Index" href='#/artists?')
                                                            i.fa-light.fa-fw.fa-address-book
                                                            | Artists
                                                    a.user-menu-item(class=`user-menu-overlow-icon-2${(next_episode) ? '-nep' : ''}`  title="Show History" href='#_' class="collapsed" data-toggle="collapse" data-target="#menuItemHistory" onClick='getHistory(); return false;')
                                                        i.fa-light.fa-fw.fa-history
                                                        | History
                                                    a.user-menu-item(title="I'm feeling lucky!" href='#/gallery?sort=random')
                                                        i.fa-light.fa-fw.fa-dice
                                                        | Random
                                                    if (enableUploadTools && (params && (path === '/gallery' || path === '/files' || path === '/cards' || path === '/listTheater' || path === '/tvTheater')))
                                                        if (write_channels && write_channels.length > 0 && !(manage_channels && manage_channels.length > 0) && !(download && download.length > 0))
                                                            if (active_ch && params && !(params.getAll('channel')[0] === 'random' || !(params.has('channel') || params.has('folder') || params.has('album') || params.has('album_name'))))
                                                                a.user-menu-item(title="Upload File" href='#_' data-ch-name=full_title data-ch-server=active_svr onclick='selectedUploadChannel("' + active_ch + '", "uploadModel", false); displayUploadModel(); return false;')
                                                                    i.fa-light.fa-upload
                                                                    | Upload
                                                            else
                                                                a.user-menu-item(title="Upload File" href='#_' onclick='displayUploadModel(); return false;')
                                                                    i.fa-light.fa-upload
                                                                    | Upload
                                                        else
                                                            a.user-menu-item(title="Upload Items" href='#_' class="collapsed" data-toggle="collapse" data-target="#menuItemUpload")
                                                                i.fa-light.fa-fw.fa-upload
                                                                | Upload
                                                    a.user-menu-item(title="Installed Applications" href='#_' class="collapsed" data-toggle="collapse" data-target="#menuItemApps")
                                                        i.fa-light.fa-fw.fa-browsers
                                                        | Apps
                                                    a#userToolsDropdown.user-menu-item(title="Tools" href='#_' class="collapsed" data-toggle="collapse" data-target="#menuItemTools")
                                                        i.fa-light.fa-fw.fa-toolbox
                                                        | Tools
                                                    a#userOptionsDropdown.user-menu-item(title="User and Session Options" href='#_' class="collapsed" data-toggle="collapse" data-target="#menuItemSettings")
                                                        i.fa-light.fa-fw.fa-cog
                                                        | Settings

                                    if (appData)
                                        div.w-100(class="collapse show animated--grow-in" data-parent="#menuAccordion" id=`menuItemMain`)
                                            div.position-relative.user-menu-height(style="width: 100%;")
                                                .d-flex.w-100#appMenuRow1.align-items-center
                                                    a(class="btn btn-primary collapsed" data-toggle="collapse" data-target="#menuItemMainSeq").d-flex.align-items-center.py-0
                                                        i.fas.fa-house.fa-fw.d-none
                                                        img.my-2.sidebar-brand-logo.main-logo-small(src='/static/img/sequenzia-logo-mini.png' style='height: 1.4em;')
                                                    h4.text-primary.ml-auto.text-ellipsis.mb-0
                                                        i.fas.mr-2(class=`${appData.icon}`)
                                                        span #{appData.name}

                                                .row.w-100.position-absolute.pb-3.ml-0.mr-0(style='bottom: 0; left: 0;').d-flex.justify-content-center#appMenuRow2
                                                    .menu-grid#appMenuRow2Grid
                                    div.w-100(class=`collapse ${(path && (path === '/tvTheater' || path === '/listTheater')) ? 'show' : ''}` data-parent="#menuAccordion" id=`${(path && (path === '/tvTheater' || path === '/listTheater')) ? 'menuItemMain' : 'menuItemTheater' }`).kms-main-menu.animated--grow-in
                                        .d-flex.w-100
                                            if (next_episode)
                                                div.mr-3.outer-menu-next-episode(onclick=`getNewContent([],[["show_id","${next_episode.show_id}"]${(next_episode.nsfw === 1) ? ',["nsfw","true"]':''}${(!next_episode.data.seasons) ? ',["sort","name"]':''}],'/listTheater')`)
                                                    img.border-left-warning.rounded.kongou-next-episode-image(src=`${(next_episode.poster) ? 'https://media.discordapp.net/attachments' + next_episode.poster : next_episode.data.poster[0]}`)
                                            div.position-relative.user-menu-height(style="width: 100%;")
                                                .d-flex.w-100#appMenuRow1.align-items-center
                                                    if (path && (path === '/tvTheater' || path === '/listTheater'))
                                                        a(class="btn btn-primary collapsed" data-toggle="collapse" data-target="#menuItemMainSeq").d-flex.align-items-center.py-0
                                                            i.fas.fa-house.fa-fw.d-none
                                                            img.my-2.sidebar-brand-logo.main-logo-small(src='/static/img/sequenzia-logo-mini.png' style='height: 1.4em;')
                                                    else
                                                        a(class="btn btn-primary collapsed" data-toggle="collapse" data-target="#menuItemMain")
                                                            i.fas.fa-arrow-left.fa-fw
                                                    h4.text-primary.ml-auto.mb-0
                                                        img.kms-menu-logo(src='/static/img/kongoumedialogo-menu-dark.png' style="height: 1.6em;")
                                                .row.w-100.position-absolute.pb-3(style='bottom: 0; left: 0;').d-flex.justify-content-center.ml-0.mr-0
                                                    if (next_episode)
                                                        div.inner-menu-next-episode(onclick=`getNewContent([],[["show_id","${next_episode.show_id}"]${(next_episode.nsfw === 1) ? ',["nsfw","true"]' : ''}${(!next_episode.data.seasons) ? ',["sort","name"]' : ''}],'/listTheater')`)
                                                            img.border-left-warning.rounded.kongou-next-episode-image(src=`${(next_episode.poster) ? 'https://media.discordapp.net/attachments' + next_episode.poster : next_episode.data.poster[0]}`)
                                                    if (theaters && theaters.length > 0)
                                                        .menu-grid.kms-main-grid.mt-auto.ml-auto.mr-auto
                                                            a.user-menu-item.user-menu-small(title="Continue Ongoing Series" href='#/listTheater?watch_history=none')
                                                                i.fa-light.fa-forward
                                                                | Up Next
                                                            a.user-menu-item(title="Media Shelves" href='#_' class="collapsed" data-toggle="collapse" data-target="#menuItemMediaGroups")
                                                                i.fa-light.fa-fw.fa-books
                                                                | Shelves
                                                            a.user-menu-item.user-menu-small(title="Newest Episodes" href='#/listTheater?numdays=1&sort=eid&num=25')
                                                                i.fa-light.fa-certificate
                                                                | Newest
                                                            a.user-menu-item.user-menu-small(data-placement="left" title="Favorite Episodes" href='#/listTheater?pins=true')
                                                                i.fa-light.fa-star
                                                                | Favorites
                                                            a.user-menu-item.user-menu-small(data-placement="left" title="Watch History" href='#/listTheater?watch_history=only')
                                                                i.fa-light.fa-clock-rotate-left
                                                                | History
                                                    else
                                                        div.mt-auto.ml-auto.mr-auto.h3
                                                            i.fas.fa-shelves-empty.pr-2
                                                            span No Library Access
                                    div#menuItemSettings.w-100(class="collapse animated--fade-in" data-parent="#menuAccordion")
                                        div.position-relative.user-menu-height(style="width: 100%;")
                                            .d-flex.w-100.align-items-center
                                                a(class="btn btn-primary collapsed" data-toggle="collapse" data-target=`#menuItemMain${(appData || (path && (path === '/tvTheater' || path === '/listTheater'))) ? 'Seq' : ''}`)
                                                    i.fas.fa-arrow-left.fa-fw
                                                .input-group.ml-2(style='max-width: 180px;')
                                                    input#expressLoginCode(type='text' placeholder='A1B2C3' style="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false").m-0.form-control.form-text.input-group-text.border-left-0.text-uppercase
                                                    .input-group-append
                                                        a.input-group-text.btn-primary.border-0.bg-translucent(title="Transfer Login to this device" href='#_' onClick=`authwareLogin(); return false;`)
                                                            i.fa-light.fa-key.fa-sm.align-middle.nav-item.text-primary
                                                            span.ml-2 Login
                                                h4.text-primary.ml-auto.mb-0
                                                    i.fas.fa-cog.mr-sm-2
                                                    span.d-none.d-sm-inline Settings
                                            .row.w-100.position-absolute.pb-3(style='bottom: 0; left: 0;').d-flex.justify-content-center.ml-0.mr-0
                                                .menu-grid
                                                    a.user-menu-item.user-menu-small(title="Manage Storage and Offline Content" href='#_' onclick=`displayOfflineData(); return false;`)
                                                        i.fa-light.fa-sd-card
                                                        | Storage
                                                    if (login_source && login_source < 900)
                                                        a.user-menu-item.user-menu-small(title="Hide Channels you don't frequently view" href='#_' onclick=`$("#userMenu").collapse("hide"); $('#hiddenChannelModel').modal('show'); return false;`)
                                                            i.fa-light.fa-compass-slash
                                                            | Hide Channels
                                                    a.user-menu-item.user-menu-small(title="Toggle Performance Mode" href='#_' onclick=`togglePerformanceMode(); return false;`)
                                                        i.fa-light.fa-bolt
                                                        | Performance
                                                    a.user-menu-item.user-menu-small(title="About" href='#_' data-toggle='modal' data-target='#aboutModal' onclick='$("#userMenu").collapse("hide");')
                                                        i.fa-light.fa-info-circle
                                                        | About
                                                    if (login_source && login_source < 900)
                                                        a.user-menu-item.user-menu-small(data-placement="left" title="Authentication Manager" href='#_' onclick='$("#userMenu").collapse("hide"); showAuthManager(); return false;')
                                                            i.fa-light.fa-key
                                                            | Security
                                                    a.user-menu-item.user-menu-small(title="Logout" href='#_' data-toggle='modal' data-target='#logoutModal')
                                                        i.fa-light.fa-sign-out-alt
                                                        | Logout
                                    div#menuItemTools.w-100(class="collapse animated--fade-in" data-parent="#menuAccordion")
                                        div.position-relative.user-menu-height(style="width: 100%;")
                                            .d-flex.w-100.align-items-center
                                                a(class="btn btn-primary collapsed" data-toggle="collapse" data-target=`#menuItemMain${(appData || (path && (path === '/tvTheater' || path === '/listTheater'))) ? 'Seq' : ''}`)
                                                    i.fas.fa-arrow-left.fa-fw
                                                h4.text-primary.ml-auto.mb-0
                                                    i.fas.fa-toolbox.mr-2
                                                    | Tools
                                            .row.w-100.position-absolute.pb-3(style='bottom: 0; left: 0;').d-flex.justify-content-center.ml-0.mr-0
                                                .menu-grid
                                                    if (params && path !== '/artists')
                                                        a.user-menu-item.user-menu-small(title="Display Settings" href='#_' class="collapsed" data-toggle="collapse" data-target="#menuItemDisplay")
                                                            i.fa-light.fa-sliders-h
                                                            | Display
                                                    a.user-menu-item.user-menu-small(title="Manage Storage and Offline Content" href='#_' onclick=`$('#cachePageModal').modal('show'); return false;`)
                                                        i.fa-light.fa-bookmark
                                                        | Offline
                                                    a.user-menu-item.user-menu-small(data-placement="left" title="Refresh Offline Pages" href='#_' onclick="requestSyncPages(); return false;")
                                                        i.fa-light.fa-sync
                                                        | Sync
                                                    if (params && path !== '/artists' && !(appData || (path && (path === '/tvTheater' || path === '/listTheater'))))
                                                        a.user-menu-item.user-menu-small(title="Download all images" href='#_' onclick="$('#userMenu').collapse('hide'); downloadAllItems(); return false;" role='button')
                                                            i.fa-light.fa-download
                                                            | Download
                                                        a.user-menu-item.user-menu-small.hide-review(title="View RSS Feed URL's" href='#_' onclick="$('#userMenu').collapse('hide'); $('#feedModel').modal('show'); return false;" role='button')
                                                            i.fa-light.fa-square-rss
                                                            | RSS Feed
                                                        if (android_uri)
                                                            a.user-menu-item.user-menu-small.hide-review(title="Send current page results to Wallpaper Service" href='#_' role='button' onclick="$('#userMenu').collapse('hide'); $('#appModal').modal('show'); return false;")
                                                                i.fa-light.fa-laptop
                                                                | Set Wallpaper
                                                        a.user-menu-item.user-menu-small.hide-review(title="Send current page results to an Ambient Display or Photo Frame" href='#_' role='button' onclick="$('#userMenu').collapse('hide'); loadADSDisplays(); return false;")
                                                            i.fa-light.fa-image-landscape
                                                            | Set Frame
                                                    a.user-menu-item(class=`user-menu-overlow-icon-2${(next_episode) ? '-nep' : ''}` title="Show Image History" href='#_' class="collapsed" data-toggle="collapse" data-target="#menuItemHistory" onClick='getHistory(); return false;')
                                                        i.fa-light.fa-fw.fa-history
                                                        | History
                                    div#menuItemDisplay.w-100(class="collapse animated--fade-in" data-parent="#menuAccordion")
                                        div.position-relative.user-menu-height(style="width: 100%;")
                                            .d-flex.w-100.align-items-center
                                                a(class="btn btn-primary collapsed" data-toggle="collapse" data-target="#menuItemTools")
                                                    i.fas.fa-arrow-left.fa-fw
                                                if (!(appData || (path && (path === '/tvTheater' || path === '/listTheater'))))
                                                    form.form-group.mb-0.mt-0.ml-2(onsubmit="return false;" method="POST")
                                                        .input-group(style='max-width: 180px;')
                                                            .input-group-prepend
                                                                span.input-group-text.bg-translucent.border-0
                                                                    i.fa-light.fa-grid.fa-sm.align-middle.text-primary
                                                            input(type="submit" style="display: none" onclick=`getLimitContent(); return false;`)
                                                            input#limitRequested.form-control.bg-translucent.border-0.small.text-left(type='text' value=req_limit)
                                                            .input-group-append
                                                                a.input-group-text.btn-primary.border-0.bg-translucent(title="Get Temp Limit" href='#_', onclick=`getLimitContent(); return false;`)
                                                                    i.fa-light.fa-sync.fa-sm.align-middle.nav-item.text-primary
                                                                a.input-group-text.btn-primary.border-0.bg-translucent(title="Set New Limit" href='#_', onclick=`getLimitContent(true); return false;`)
                                                                    i.fa-light.fa-floppy-disk.fa-sm.align-middle.nav-item.text-primary
                                                h4.text-primary.ml-auto.mb-0
                                                    if (!(appData || (path && (path === '/tvTheater' || path === '/listTheater'))))
                                                        i.fas.fa-sliders-h.mr-sm-2
                                                        span.d-none.d-sm-inline Display
                                                    else
                                                        i.fas.fa-sliders-h.mr-2
                                                        span Display
                                            .row.w-100.position-absolute.pb-3(style='bottom: 0; left: 0;').d-flex.justify-content-center.ml-0.mr-0
                                                .menu-grid
                                                    if (results && (path === '/gallery' || path === '/tvTheater'))
                                                        a.user-menu-item.user-menu-small(href='#_' onclick=`setImageLayout(3); return false;`)
                                                            i.fa-light.fa-grid-5
                                                            | Thumbs
                                                        a.user-menu-item.user-menu-small(href='#_' onclick=`setImageLayout(2); return false;`)
                                                            i.fa-light.fa-grid-4
                                                            | Small
                                                        a.user-menu-item.user-menu-small(href='#_' onclick=`setImageLayout(); return false;`)
                                                            i.fa-light.fa-grid
                                                            | Default
                                                        a.user-menu-item.user-menu-small(href='#_' onclick=`setImageLayout(1); return false;`)
                                                            i.fa-light.fa-grid-2
                                                            | Large
                                                    a.user-menu-item.user-menu-small(href='#_' onclick=`setPageLayout(true); return false;`)
                                                        i.fa-light.fa-distribute-spacing-horizontal
                                                        | Full Width
                                                    a.user-menu-item.user-menu-small(href='#_' onclick=`setMenuBarLocation(); return false;`)
                                                        i.fa-light.fa-arrow-up-arrow-down
                                                        | Menubar
                                                    if (!appData || (path && (path === '/tvTheater' || path === '/listTheater')))
                                                        if (path !== '/gallery')
                                                            a.user-menu-item.user-menu-small(title="View results as a gallery" href='#_' onclick=`getNewContent(['offset'], [], "/gallery?${(req_uri.split('?').length > 1) ? req_uri.split('?').pop() : ''}"); return false;` role='button')
                                                                i.fa-duotone.fa-folder-image
                                                                | As Gallery
                                                        if (path !== '/files')
                                                            a.user-menu-item.user-menu-small(title="View results as file list" href='#_' onclick=`getNewContent(['offset'], [], "/files?${(req_uri.split('?').length > 1) ? req_uri.split('?').pop() : ''}"); return false;` role='button')
                                                                i.fa-duotone.fa-folder
                                                                | As Files
                                                        if (path !== '/cards')
                                                            a.user-menu-item.user-menu-small(title="View results as a cards list" href='#_' onclick=`getNewContent(['offset'], [], "/cards?${(req_uri.split('?').length > 1) ? req_uri.split('?').pop() : ''}"); return false;` role='button')
                                                                i.fa-duotone.fa-folder-grid
                                                                | As Cards
                                                        if (params.getAll('nsfw')[0] === 'true' || (nsfwEnabled))
                                                            a.user-menu-item.user-menu-small(title="Exclude NSFW Content" href='#_' onclick=`getNewContent(['offset'], [['nsfwEnable','false']]); return false;`)
                                                                i.fa-light.fa-shield-cat
                                                                | SFW Mode
                                                        else
                                                            a.user-menu-item.user-menu-small(title="Include NSFW Content" href='#_' onclick=`getNewContent(['offset'], [['nsfwEnable','true'],['nsfw','true']]); return false;`)
                                                                i.fa-duotone.fa-shield-slash
                                                                | NSFW Mode
                                                        if (params.has('flagged') && params.getAll('flagged')[0] !== 'true')
                                                            a.user-menu-item.user-menu-small(title="Show All Content" href='#_' onclick=`getNewContent(['offset', 'flagged'], []); return false;`)
                                                                i.fa-light.fa-flag-checkered
                                                                | Remove Flagged
                                                        else
                                                            a.user-menu-item.user-menu-small(title="Show only Flagged Content" href='#_' onclick=`getNewContent(['offset'], [['flagged','true']]); return false;`)
                                                                i.fa-light.fa-flag
                                                                | Only Flagged
                                    div#menuItemUpload.w-100(class="collapse animated--fade-in" data-parent="#menuAccordion")
                                        div.position-relative.user-menu-height(style="width: 100%;")
                                            .d-flex.w-100.align-items-center
                                                a(class="btn btn-primary collapsed" data-toggle="collapse" data-target=`#menuItemMain${(appData || (path && (path === '/tvTheater' || path === '/listTheater'))) ? 'Seq' : ''}`)
                                                    i.fas.fa-arrow-left.fa-fw
                                                h4.text-primary.ml-auto.mb-0
                                                    i.fas.fa-upload.mr-2
                                                    | Upload
                                            .row.w-100.position-absolute.pb-3(style='bottom: 0; left: 0;').d-flex.justify-content-center.ml-0.mr-0
                                                .menu-grid
                                                    if (write_channels && write_channels.length > 0)
                                                        if (active_ch && params && !(params.getAll('channel')[0] === 'random' || !(params.has('channel') || params.has('folder') || params.has('album') || params.has('album_name'))))
                                                            a.user-menu-item(title="Upload File" href='#_' data-ch-name=full_title data-ch-server=active_svr onclick='$("#userMenu").collapse("hide"); selectedUploadChannel("' + active_ch + '", "uploadModel", false); displayUploadModel(); return false;')
                                                                i.fa-light.fa-upload.pr-2
                                                                | Upload File
                                                        else
                                                            a.user-menu-item(title="Upload File" href='#_' onclick='displayUploadModel(); return false;')
                                                                i.fa-light.fa-upload.pr-2
                                                                | Upload File
                                                    if (manage_channels && manage_channels.length > 0)
                                                        if (active_ch && params && !(params.getAll('channel')[0] === 'random' || !(params.has('channel') || params.has('folder') || params.has('album') || params.has('album_name'))))
                                                            a.user-menu-item(title="Send Message" href='#_' data-ch-name=full_title data-ch-server=active_svr onclick='$("#userMenu").collapse("hide"); selectedUploadChannel("' + active_ch + '", "writeModel", false); displayMessageModel(0); return false;')
                                                                i.fa-light.fa-edit.pr-2
                                                                | Send Message
                                                        else
                                                            a.user-menu-item(title="Send Message" href='#_' onclick='displayMessageModel(0); return false;')
                                                                i.fa-light.fa-edit.pr-2
                                                                | Send Message
                                                    if (download && download.length > 0)
                                                        if (active_ch && params && !(params.getAll('channel')[0] === 'random' || !(params.has('channel') || params.has('folder') || params.has('album') || params.has('album_name'))))
                                                            a.user-menu-item(title="Download File from URL" href='#_' data-ch-name=full_title data-ch-server=active_svr onclick='$("#userMenu").collapse("hide"); selectedUploadChannel("' + active_ch + '", "writeModel", true); displayMessageModel(1); return false;')
                                                                i.fa-light.fa-cloud-download-alt.pr-2
                                                                | Download URL
                                                        else
                                                            a.user-menu-item(title="Download File from URL" href='#_' onclick='$("#userMenu").collapse("hide"); displayMessageModel(1); return false;')
                                                                i.fa-light.fa-cloud-download-alt.pr-2
                                                                | Download URL

                                    div#menuItemAlbums.scroll-list.w-100(class="collapse animated--fade-in" data-parent="#menuAccordion")
                                        div.position-relative.user-menu-height(style="width: 100%;")
                                            .d-flex.w-100.align-items-center
                                                a(class="btn btn-primary collapsed" data-toggle="collapse" data-target=`#menuItemMain${(appData || (path && (path === '/tvTheater' || path === '/listTheater'))) ? 'Seq' : ''}`)
                                                    i.fas.fa-arrow-left.fa-fw
                                                a(class="btn btn-primary" title="Manage Your Albums" href='#_' onclick='getAlbumDirectory(); return false;').ml-2
                                                    i.fas.fa-fw.mr-md-1.fa-globe-americas
                                                    span.d-none.d-md-inline Directory
                                                a(class="btn btn-primary" title="Manage Your Albums" href='#_' onclick='refreshAlbumsList(); return false;').ml-2
                                                    i.fas.fa-cog.fa-fw.mr-md-1
                                                    span.d-none.d-md-inline Manage
                                                h4.text-primary.ml-auto.mb-0
                                                    i.fas.fa-archive.mr-2
                                                    | Albums
                                            .w-100.position-absolute(style="justify-content: left; top: 3em;")
                                                if (albums && albums.length > 0)
                                                    div.album-list.pb-1(style='overflow-x: auto; overflow-y:hidden; white-space: nowrap;')
                                                        each thisAlbum in albums
                                                            div.album-item.position-relative
                                                                div.album-info.position-absolute.shadow-text.text-ellipsis.pl-2.pr-2.pt-1(style="justify-content: left; top: 0;")
                                                                    //x.uri, x.privacy
                                                                    div.album-icon
                                                                        if (thisAlbum.uri === 'gallery')
                                                                            i.far.fa-photo-video.pr-1
                                                                        else if (thisAlbum.uri === 'files')
                                                                            i.far.fa-folder.pr-1
                                                                        else if (thisAlbum.uri === 'cards')
                                                                            i.far.fa-sticky-note.pr-1
                                                                        else
                                                                            i.far.fa-archive.pr-1

                                                                        if (thisAlbum.privacy === 0)
                                                                            i.far.fa-globe-americas.pr-1
                                                                        else if (thisAlbum.privacy === 1)
                                                                            i.far.fa-lock.pr-1
                                                                        else if (thisAlbum.privacy === 2)
                                                                            i.far.fa-link.pr-1
                                                                div.album-info.position-absolute.shadow-text.text-ellipsis.pl-2.pr-2(style="justify-content: left; bottom: 0; left: 0;")
                                                                    span #{thisAlbum.name}
                                                                a.position-absolute.text-capitalize(style='height: 100%; width: 100%' data-tooltip="tooltip" data-trigger="hover" data-placement="right" title=thisAlbum.name href=`#/${thisAlbum.uri}?album=${thisAlbum.aid}&sort=album`)
                                                                    if (thisAlbum.image)
                                                                        div.album-preview.rounded(style=`background-image: url("${thisAlbum.image}");`)
                                                                    else
                                                                        div.album-preview.rounded(style=`background: linear-gradient(31deg, #9f3202, #f7c21c);`)

                                                else
                                                    div.mt-auto.mb-auto.ml-auto.mr-auto.h3.p-3
                                                        i.fas.fa-empty-set.pr-2
                                                        span No Albums
                                    div#menuItemArtists.scroll-list.w-100(class="collapse animated--fade-in" data-parent="#menuAccordion")
                                        div.position-relative.user-menu-height(style="width: 100%;")
                                            .d-flex.w-100.align-items-center
                                                a(class="btn btn-primary collapsed" data-toggle="collapse" data-target=`#menuItemMain${(appData || (path && (path === '/tvTheater' || path === '/listTheater'))) ? 'Seq' : ''}`)
                                                    i.fas.fa-arrow-left.fa-fw
                                                a(class="btn btn-primary" title="Artist Index" href='#/artists?').ml-2
                                                    i.fas.fa-fw.mr-md-1.fa-grid-2
                                                    span.d-none.d-md-inline Index
                                                h4.text-primary.ml-auto.mb-0
                                                    i.fas.fa-address-book.mr-2
                                                    | Artists
                                            .w-100.position-absolute(style="justify-content: left; top: 3em;")
                                                if (artists && artists.length > 0)
                                                    div.album-list.pb-1(style='overflow-x: auto; overflow-y:hidden; white-space: nowrap;')
                                                        each thisArtist in artists
                                                            div.album-item.position-relative
                                                                div.album-info.position-absolute.shadow-text.text-ellipsis.pl-2.pr-2.pt-1(style="justify-content: left; top: 0;")
                                                                    //x.uri, x.privacy
                                                                    div.album-icon
                                                                        if (thisArtist.artist_source && thisArtist.artist_source === 1)
                                                                            i.fab.fa-twitter.pr-1
                                                                        else if (thisArtist.artist_source && thisArtist.artist_source === 2)
                                                                            i.fas.fa-palette.pr-1
                                                                        else if (thisArtist.artist_source && thisArtist.artist_source === 3)
                                                                            i.fab.fa-flickr.pr-1
                                                                        else if (thisArtist.artist_source && thisArtist.artist_source === 4)
                                                                            i.fas.fa-download.pr-1

                                                                        if (thisArtist.artist_confidence && thisArtist.artist_confidence === 1)
                                                                            i.fas.fa-check-circle.ml-1.pr-1

                                                                        if (thisArtist.artist_rating)
                                                                            if (thisArtist.artist_rating >= 0.9)
                                                                                i.fas.fa-face-smile.ml-1.pr-1
                                                                            else if (thisArtist.artist_rating >= 0.75)
                                                                                i.fas.fa-face-meh.ml-1.pr-1
                                                                            else if (thisArtist.artist_rating >= 0.50)
                                                                                i.fas.fa-face-frown.ml-1.pr-1
                                                                            else
                                                                                i.fas.fa-face-meh-blank.ml-1.pr-1
                                                                            span #{(thisArtist.artist_rating * 100).toFixed(0)}%

                                                                div.album-info.position-absolute.shadow-text.text-ellipsis.pl-2.pr-2(style="justify-content: left; bottom: 0; left: 0;")
                                                                    span #{(thisArtist.artist_full_name) ? thisArtist.artist_full_name + ((thisArtist.artist && thisArtist.artist.toLowerCase() !== thisArtist.artist_full_name.toLowerCase()) ? " (" + thisArtist.artist + ")" : "") : thisArtist.artist}
                                                                a.position-absolute.text-capitalize(style='height: 100%; width: 100%' data-tooltip="tooltip" data-trigger="hover" data-placement="right" title=((thisArtist.artist_full_name) ? thisArtist.artist_full_name : thisArtist.artist) href=`#/gallery?nsfw=true&search=${encodeURIComponent(thisArtist.artist_search)}`)
                                                                    if (thisArtist.image)
                                                                        div.album-preview.rounded(style=`background-image: url("${thisArtist.image}");`)
                                                                    else
                                                                        div.album-preview.rounded(style=`background: linear-gradient(31deg, #9f3202, #f7c21c);`)

                                                else
                                                    h2 No Favorite Artists!
                                    div#menuItemHistory.scroll-list.w-100(class="collapse animated--fade-in" data-parent="#menuAccordion")
                                        div.position-relative.user-menu-height(style="width: 100%;")
                                            .d-flex.w-100.align-items-center
                                                a(class="btn btn-primary collapsed" data-toggle="collapse" data-target=`#menuItemMain${(appData || (path && (path === '/tvTheater' || path === '/listTheater'))) ? 'Seq' : ''}`)
                                                    i.fas.fa-arrow-left.fa-fw
                                                a(class="btn btn-primary" title="Show All Image History" href=`#/gallery?sort=history&history_numdays=90&history=only&displayname=*`).ml-2
                                                    i.fas.fa-fw.mr-md-1.fa-grid-2
                                                    span.d-none.d-md-inline Show All
                                                a(class="btn btn-primary" title="Show Page Access History" href='#_' onclick="$('#historyModel').modal('show'); return false;").ml-2
                                                    i.fas.fa-fw.mr-md-1.fa-history
                                                    span.d-none.d-md-inline Navi History
                                                a(class="btn btn-primary" title="Manage Photo Frames" href='#_' onclick='showDisplayHistory(); return false;').ml-2
                                                    i.fas.fa-fw.mr-md-1.fa-cog
                                                    span.d-none.d-md-inline Manage
                                                #menuLoaderImageHistory.d-inline.ml-2
                                                    i.fas.fa-spin-pulse.fa-spinner
                                                h4.text-primary.ml-auto.mb-0
                                                    i.fas.fa-rectangle-history.mr-2
                                                    | History
                                            .w-100.position-absolute(style="justify-content: left; top: 3em;")
                                                div.album-list.pb-1(style='overflow-x: auto; overflow-y:hidden; white-space: nowrap;')
                                                    #menuBodyImageHistory.ready(style="display: contents;")
                                                        span Loading...
                                    div#menuItemApps.w-100(class="collapse animated--fade-in" data-parent="#menuAccordion")
                                        div.position-relative.user-menu-height(style="width: 100%;")
                                            .d-flex.w-100.align-items-center
                                                a(class="btn btn-primary collapsed" data-toggle="collapse" data-target=`#menuItemMain${(appData || (path && (path === '/tvTheater' || path === '/listTheater'))) ? 'Seq' : ''}`)
                                                    i.fas.fa-arrow-left.fa-fw
                                                h4.text-primary.ml-auto.mb-0
                                                    i.fas.fa-browsers.mr-2
                                                    | Applications
                                            .row.w-100.position-absolute.pb-3(style='bottom: 0; left: 0;').d-flex.justify-content-center.ml-0.mr-0
                                                .menu-grid(style='overflow-x: auto; overflow-y:hidden; white-space: nowrap;')
                                                    a.user-menu-item.user-menu-small(title="Launch Ambient Display Web App" href='/ambient?displayname=Untitled' target="_blank" rel="noopener noreferrer")
                                                        i.fa-light.fa-tv
                                                        | Photo Frame
                                                    a.user-menu-item.user-menu-small(title="Launch Offline Mode" href='#_' onclick="transitionToOOBPage('/offline'); return false;")
                                                        i.fa-light.fa-folder-bookmark
                                                        | Local Files
                                                    if (applications_list && applications_list.length > 0)
                                                            each thisApp in applications_list
                                                                if (thisApp.type == 0)
                                                                    a.user-menu-item.user-menu-small(title=`Open ${thisApp.name}` href=thisApp.url target="_blank" rel="noopener noreferrer")
                                                                        i.fa-light(class=`${thisApp.icon}`)
                                                                        | #{thisApp.name}
                                                                else if (thisApp.type == 1)
                                                                    a.user-menu-item.user-menu-small(title=`Launch ${thisApp.name}` href=`#/app/launch/${thisApp.id}`)
                                                                        i.fa-light(class=`${thisApp.icon}`)
                                                                        | #{thisApp.name}
                                                                else if (thisApp.type == 2)
                                                                    a.user-menu-item.user-menu-small(title=`Launch ${thisApp.name}` href=`#/app/launch/${thisApp.id}`)
                                                                        i.fa-light(class=`${thisApp.icon}`)
                                                                        | #{thisApp.name}
                                    div#menuItemMediaGroups.w-100(class="collapse animated--fade-in" data-parent="#menuAccordion")
                                        div.position-relative.user-menu-height(style="width: 100%;")
                                            .d-flex.w-100.align-items-center
                                                a(class="btn btn-primary collapsed" data-toggle="collapse" data-target=`#${(path && (path === '/tvTheater' || path === '/listTheater')) ? 'menuItemMain' : 'menuItemTheater'}`)
                                                    i.fas.fa-arrow-left.fa-fw
                                                h4.text-primary.ml-auto.mb-0
                                                    i.fas.fa-books.mr-2
                                                    | Shelves
                                            .row.w-100.position-absolute.pb-3(style='bottom: 0; left: 0;').d-flex.justify-content-center.ml-0.mr-0
                                                .menu-grid(style='overflow-x: auto; overflow-y:hidden; white-space: nowrap;')
                                                    if (theaters && theaters.length > 0)
                                                        each thisTheater in theaters
                                                            //if (thisTheater.type === 2)
                                                            a.user-menu-item.user-menu-small(title=`Browse ${thisTheater.name} Collection` href=`#/tvTheater?group=${thisTheater.media_group}`)
                                                                i.fa-light(class=`${thisTheater.icon}`)
                                                                | #{thisTheater.name}
                                                            //else if (thisTheater.type === 1)
                                                                a.user-menu-item.user-menu-small(title=`Browse ${thisTheater.name} Collection` href=`#/movieTheater?group=${thisTheater.media_group}`)
                                                                    i.fa-light(class=`${thisTheater.icon}`)
                                                                    | #{thisTheater.name}
                                                    else
                                                        h2 No Theaters Available
                                    div#appPanels.w-100(style=`display: contents;`)
                        nav#topbar.navbar.navbar-expand.navbar-light.topbar.bg-topbar-primary.ready-to-scroll
                            //ul.navbar-nav.text-primary.text-ellipsis
                                li.nav-item.text-right.d-none.d-md-block.page-title.text-primary.mr-1
                                    img.sidebar-brand-logo.main-logo-small(src='/static/img/sequenzia-logo-mini.png' style='height: 1.8em; opacity: 0.78;')
                            //ul.navbar-nav.d-md-none.text-primary
                                li.nav-item.page-title.no-arrow
                                    a.nav-item.btn.btn-navigation.pl-0.pr-1.align-middle(title="Menu" href='#_' role='button' accesskey="," id="sidebarToggleTop2" onclick="scrollToTop(); toggleMenu(); return false;" )
                                        i.far.fa-compass
                            #titleBarContents.col.p-0(style='display: contents; -webkit-app-region: drag;')
                                if (appData)
                                    ul.navbar-nav.text-primary.text-ellipsis
                                        li#topAddressBarInfo.nav-item.text-right.page-title.text-primary.mr-1
                                            i.far(class=`${appData.icon}`).mr-2
                                            span.text-uppercase #{appData.name}

                                else
                                    ul.navbar-nav.text-primary.text-ellipsis(onclick="$('#historyModel').modal('show'); return false;")
                                        li#topAddressBarInfo.nav-item.text-right.page-title.text-primary.mr-1
                                            if (!title || title === '')
                                                if (params && (params.getAll('channel')[0] === 'random' || !(params.has('channel') || params.has('folder') || params.has('album') || params.has('album_name'))))
                                                    if (results && results.length === 1 && params && params.has('search'))
                                                        i.far.fa-photo-video.mr-2
                                                        span.text-uppercase Item Details
                                                    else if (search_prev)
                                                        if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                            i.far.fa-star.mr-2
                                                        else if (search_prev && search_prev.startsWith('id:st'))
                                                            i.far.mr-2.fa-asterisk
                                                        else
                                                            i.far.fa-search.mr-2
                                                        if (params && path === '/artists')
                                                            span.text-uppercase Artist Search
                                                        else if (params && search_prev.startsWith('id:st'))
                                                            span.text-uppercase Related Items
                                                        else
                                                            span.text-uppercase Search
                                                    else if (params && path === '/artists')
                                                        i.far.fa-atlas.mr-2
                                                        span(title='Global Artist Search').text-uppercase Artists
                                                    else if (path === '/listTheater' && params.has('watch_history'))
                                                        if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                            i.far.fa-star.mr-2
                                                        else if (params.getAll('watch_history')[0] === 'none')
                                                            i.far.fa-forward.mr-2
                                                            span(title='Continue Watching').text-uppercase Up Next
                                                        else
                                                            i.far.fa-history.mr-2
                                                            span(title='Watch History').text-uppercase Watch History
                                                    else if (path === '/listTheater')
                                                        if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                            i.far.fa-star.mr-2
                                                            span(title='Favorite Episodes').text-uppercase Favorites
                                                        else if (params && params.has('sort') && params.getAll('sort')[0] === 'eid')
                                                            i.far.fa-certificate.mr-2
                                                            span(title='Latest Episodes').text-uppercase Latest Episodes
                                                        else if (params && params.has('show_id') && params.getAll('show_id')[0] === 'unmatched')
                                                            i.far.fa-shelves.mr-2
                                                            span(title='Unmatched Video Files').text-uppercase Unmatched Items
                                                        else
                                                            i.far.fa-ticket.mr-2
                                                            span(title='Theater Shelf').text-uppercase Theater Shelf
                                                    else if (params && params.getAll('sort')[0] === 'random')
                                                        if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                            i.far.fa-star.mr-2
                                                        else
                                                            i.far.fa-dice.mr-2
                                                        span(title='Random selection of items from the database').text-uppercase I'm Feeling Lucky
                                                    else if (tags_prev)
                                                        if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                            i.far.fa-star.mr-2
                                                        else
                                                            i.far.fa-tags.mr-2
                                                        span.text-uppercase !{tags_prev}
                                                    else if (params && params.getAll('sort')[0] === 'fav')
                                                        if (webconfig && webconfig.pinned_user && params && params.getAll('pins')[0] === webconfig.pinned_user)
                                                            i.far.fa-thumbtack.mr-2
                                                            span(title='Favorited Images by the moderation team').text-uppercase Pinned
                                                        else
                                                            i.far.fa-star.mr-2
                                                            span(title='Favorited Images').text-uppercase Favorites
                                                    else if (params.has('color'))
                                                        if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                            i.far.fa-star.mr-2
                                                        else
                                                            i.far.mr-2.fa-swatchbook
                                                        span(title='Images by there averaged colour').text-uppercase Colour search
                                                    else if (params.has('displayname'))
                                                        if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                            i.far.fa-star.mr-2
                                                        else
                                                            i.far.mr-2.fa-history
                                                        span(title='History for ' + params.getAll('displayname')[0]).text-uppercase History
                                                    else if (path === '/tvTheater')
                                                        if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                            i.far.fa-star.mr-2
                                                        else
                                                            i.far.fa-ticket.mr-2
                                                        span(title='Theater').text-uppercase Theater
                                                    else if (params && (params.getAll('sort')[0] === 'id' || params.getAll('sort')[0] === 'eid'))
                                                        if (webconfig && webconfig.pinned_user && params && params.getAll('pins')[0] === webconfig.pinned_user)
                                                            i.far.fa-thumbtack.mr-2
                                                            span(title='Favorited Images by the moderation team').text-uppercase Pinned
                                                        else if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                            i.far.fa-star.mr-2
                                                            span(title='Favorited Images').text-uppercase Favorites
                                                        else
                                                            if (path === '/files')
                                                                i.far.fa-folder.mr-2
                                                                span(title='Files in order of upload').text-uppercase Latest Files
                                                            else
                                                                i.far.fa-photo-video.mr-2
                                                                span(title='Images in order of upload').text-uppercase Latest Media
                                                    else if (params && (params.getAll('sort')[0] === 'rating'))
                                                        i.far.fa-hundred-points.mr-2
                                                        span(title='MIITS Score based on overall tags rating').text-uppercase MIITS Score
                                                    else
                                                        if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                            i.far.fa-star.mr-2
                                                        else
                                                            i.far.fa-clock.mr-2
                                                        span(title='Chronologically Feed of Images').text-uppercase Recent

                                                else if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                    i.far.fa-star.mr-2
                                                    span.text-uppercase #{full_title_post}
                                                else
                                                    if (params && masterCount || results)
                                                        i.far.fa-home.mr-2
                                                        span.d-none.d-sm-inline-block Home
                                                    else
                                                        i.far.fa-question.mr-2
                                                        span No Results
                                            else
                                                if (active_svr)
                                                    - servericon = discord.servers.list.filter(e => e.serverid === active_svr).map(e => e.icon)
                                                    if (servericon && servericon.length > 0)
                                                        - servericon = servericon.pop()
                                                    else
                                                        - servericon = null
                                                div#titleIcon(class=((servericon && full_title && full_title_post.includes(' / ')) ? 'icon-avalible' : '')).d-inline-flex
                                                    if (search_prev && search_prev.startsWith('id:st'))
                                                        i.far.mr-2.fa-asterisk
                                                    else if (tags_prev)
                                                        i.far.fa-tags.mr-2
                                                    else if (search_prev)
                                                        i.far.fa-search.mr-2
                                                    else if (params && path === '/artists')
                                                        i.far.fa-atlas.mr-2
                                                    else if (params && params.getAll('sort')[0] === 'random')
                                                        i.far.fa-dice.mr-2
                                                    else if (params && (params.has('displayname') || params.getAll('history')[0] === 'only'))
                                                        i.far.fa-history.mr-2
                                                    else if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                        i.far.fa-star.mr-2
                                                    else if (active_icon)
                                                        i.far.mr-2(class=active_icon)
                                                    else if (params && path === '/gallery')
                                                        i.far.fa-photo-video.mr-2
                                                    else if (params && path === '/files')
                                                        i.far.fa-folder.mr-2
                                                    else if (params && path === '/cards')
                                                        i.far.fa-envelope.mr-2
                                                    else if (params && path === '/tvTheater')
                                                        i.far.fa-ticket.mr-2
                                                if (full_title && full_title_post.includes(' / '))
                                                    #titleExtraStyleAdjustment.d-inline-flex
                                                    div#titleExtra.d-none.d-md-inline-flex(style='min-width: fit-content;')
                                                        if (servericon)
                                                            img.pr-1.align-self-center.rounded-circle(src=servericon style='height: 1.8rem;')
                                                            //i.far.fa-chevron-right.pr-1.align-self-baseline
                                                        each tp in full_title_post.split(' / ').reverse().splice(1).reverse()
                                                            span.pr-1.align-self-baseline.text-uppercase #{tp}
                                                            i.far.fa-chevron-right.pr-1.align-self-baseline
                                                    div#titleMain.d-inline
                                                        span.align-self-baseline.text-uppercase #{full_title_post.split(' / ').pop()}
                                                    script#setTitleExtraStyleAdjustment.
                                                        extratitlewidth = 0
                                                        calculateTitleWidthPage();

                                                else
                                                    span.text-uppercase #{full_title_post}
                                    if (results && params && !(results.length === 1 && path === '/gallery' && search_prev && search_prev !== '') && !(params.has('responseType') && params.getAll('responseType')[0] === 'offline'))
                                        ul.navbar-nav.text-primary.mr-1
                                            li#totalCount.nav-item.text-right.page-title.text-primary(style="display: contents;")
                                                span.badge.badge-danger.push-up.p-1
                                                    i.far.fa-calculator
                                ul.navbar-nav.text-primary(style="font-size: 1.4rem;")
                                    li#pageIsOffline.nav-item.mr-1.d-none
                                        i.fas.fa-bookmark
                                .mr-auto
                                if (params.has('responseType') && params.getAll('responseType')[0] === 'offline')
                                    // OFFLINE PAGE
                                else if (appData)
                                    ul#appTitleMenu.navbar-nav.text-primary.text-ellipsis(style="display: contents;")
                                    ul.navbar-nav.text-primary.text-ellipsis
                                        li.nav-item.no-arrow
                                            div#actionPanel.btn-group.hidden(style="display: contents;")
                                                a.navbar-item.btn.btn-ice.pl-2.pr-2(title="Undo the last action" href='#_' onclick='undoPendingAction(); return false;')
                                                    i.far.fa-trash-can-undo
                                                div.dropdown(style="display: contents;")
                                                    a#pendingActionsMenu.navbar-item.btn.btn-ice.py-0.px-2.fa-bounce(title="Active Tasks" href='#_' role='button' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false' aria-labelledby="pendingActionsMenu")
                                                        i.fas.fa-clipboard.pr-1
                                                        span#pendingActionsIndicator.badge.badge-primary ...
                                                    .dropdown-menu.shadow.dropdown-menu-right.animated--grow-in(aria-labelledby="pendingActionsMenu")
                                                        a.dropdown-item(onclick="commitPendingActions(); return false;")
                                                            i.fas.fa-inbox-out.pr-2
                                                            span Commit
                                                        a.dropdown-item(onclick="cancelPendingAction(-1); return false;")
                                                            i.fas.fa-trash-alt.pr-2
                                                            span Cancel

                                            div#statusPanel.btn-group.hidden(style="display: contents;")
                                                div.dropdown(style="display: contents;")
                                                    a#statusMenu.navbar-item.btn.btn-ice.py-0.px-2(title="Active Tasks" href='#_' role='button' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false' aria-labelledby="statusMenu")
                                                        i#statusMenuIcon.fas.fa-spinner
                                                        i#statusMenuIndicator.fas.fa-square-0.pl-1
                                                        div#statusMenuProgress
                                                    .dropdown-menu.shadow.dropdown-menu-right.animated--grow-in(aria-labelledby="statusMenu")
                                                        span.dropdown-header
                                                            | No Active Tasks
                                else
                                    ul.navbar-nav.text-primary.text-ellipsis
                                        li.nav-item.no-arrow
                                            div#actionPanel.btn-group.hidden(style="display: contents;")
                                                a.navbar-item.btn.btn-ice.py-0.px-2(title="Undo the last action" href='#_' onclick='undoPendingAction(); return false;')
                                                    i.far.fa-trash-can-undo
                                                div.dropdown(style="display: contents;")
                                                    a#pendingActionsMenu.navbar-item.btn.btn-ice.py-0.px-2.fa-bounce(title="Active Tasks" href='#_' role='button' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false' aria-labelledby="pendingActionsMenu")
                                                        i.fas.fa-clipboard.pr-1
                                                        span#pendingActionsIndicator.badge.badge-primary ...
                                                    .dropdown-menu.shadow.dropdown-menu-right.animated--grow-in(aria-labelledby="pendingActionsMenu")
                                                        a.dropdown-item(onclick="commitPendingActions(); return false;")
                                                            i.fas.fa-inbox-out.pr-2
                                                            span Commit
                                                        a.dropdown-item(onclick="cancelPendingAction(-1); return false;")
                                                            i.fas.fa-trash-alt.pr-2
                                                            span Cancel

                                            div#statusPanel.btn-group.hidden(style="display: contents;")
                                                div.dropdown(style="display: contents;")
                                                    a#statusMenu.navbar-item.btn.btn-ice.py-0.px-2(title="Active Tasks" href='#_' role='button' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false' aria-labelledby="statusMenu")
                                                        i#statusMenuIcon.fas.fa-spinner
                                                        i#statusMenuIndicator.fas.fa-square-0.pl-1
                                                        div#statusMenuProgress
                                                    .dropdown-menu.shadow.dropdown-menu-right.animated--grow-in(aria-labelledby="statusMenu")
                                                        span.dropdown-header
                                                            i.fas.fa-hammer.pr-1
                                                            | Compiler
                                                        div.dropdown-item.d-flex.position-relative
                                                            div
                                                                i.fas.fa-hammer.pr-1
                                                                i.fas.fa-rectangle-code.pr-1
                                                            div.d-flex(style="width: calc(58vw - (env(safe-area-inset-left,0) + env(safe-area-inset-right,0)));")
                                                                div.text-ellipsis
                                                                    span FILENAME_THAT_COULD_GET_PRETTY_LONG_SO_DEAL_WITH_IT.DAT
                                                                span.pl-1 100 GB
                                                            div
                                                                div.pl-1
                                                                    i.fas.fa-times.text-danger
                                                            div.position-absolute.h-100(style="background-color: green; width: 50%")
                                                        div.dropdown-item.d-flex
                                                            div
                                                                i.fas.fa-hourglass.pr-1
                                                            div.d-flex(style="width: calc(58vw - (env(safe-area-inset-left,0) + env(safe-area-inset-right,0)));")
                                                                div.text-ellipsis
                                                                    span FILENAME_THAT_COULD_GET_PRETTY_LONG_SO_DEAL_WITH_IT.DAT
                                                                span.pl-1 100 GB
                                                            div
                                                                div.pl-1
                                                                    i.fas.fa-times.text-danger
                                                        .dropdown-header
                                                        span.dropdown-header
                                                            | Sync
                                                        div.dropdown-item.d-flex
                                                            div
                                                                i.fas.fa-sync.pr-1
                                                            div.text-ellipsis
                                                                span PAGE NAME (000)
                                                            div
                                                                div.pl-1
                                                                    i.fas.fa-trash-alt.text-danger
                                                        .dropdown-header
                                                        span.dropdown-header
                                                            | Temporary Files

                                        li.nav-item.no-arrow.edit-btns
                                            .btn-group.show-menu-open.hidden(style="display: contents;")
                                                if (path !== '/artists' && path !== '/tvTheater' && path !== '/listTheater' && results && results.length > 1)
                                                    a.hide-review.navbar-item.btn.btn-admin.py-0.px-2(title="Select Items" href='#_' onclick='$("#userMenu").collapse("hide"); enableGallerySelect(); return false;')
                                                        i.far.fa-check-circle
                                                    if (manage_channels && manage_channels.length > 0)
                                                        a.hide-review.navbar-item.btn.btn-admin.py-0.px-2(title="Review Items" href='#_' onclick='$("#userMenu").collapse("hide"); setupReviewMode(); return false;')
                                                            i.far.fa-check-to-slot

                                                if (results && req_uri && (results.length > 0 || !(results.length === 1 && path === '/gallery' && search_prev && search_prev !== '')) && path !== '/tvTheater' && path !== '/listTheater')
                                                    div.dropdown(style="display: contents;")
                                                        a#viewMenu.navbar-item.btn.btn-ice.py-0.px-2(title="Filter and View Options" href='#_' role='button' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false' aria-labelledby="viewMenu")
                                                            i.far.fa-filter
                                                            #postRange
                                                        .dropdown-menu.shadow.dropdown-menu-right.animated--grow-in(aria-labelledby="viewMenu")
                                                            if (path === '/artists')
                                                                span.dropdown-header
                                                                    | Sort
                                                                if (params.getAll('reverse')[0] === 'true')
                                                                    a.dropdown-item(title="Sort Descending" href='#_' onclick=`getNewContent(['offset', 'reverse'], []); return false;` role='button')
                                                                        i.fas.fa-sort-amount-down.pr-2
                                                                        | Descending (A-Z)
                                                                else
                                                                    a.dropdown-item(title="Sort Ascending" href='#_' onclick=`getNewContent(['offset'], [['reverse', 'true']]); return false;` role='button')
                                                                        i.fas.fa-sort-amount-up.pr-2
                                                                        | Ascending (Z-A)
                                                                .dropdown-divider
                                                                if (params.getAll('sort')[0] !== 'count')
                                                                    a.dropdown-item(title="Sort by Total count of items" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['sort', 'count']]); return false;` role='button')
                                                                        i.fas.pr-2.fa-calculator
                                                                        | Total Count
                                                                if (params.getAll('sort')[0] !== 'name')
                                                                    a.dropdown-item(title="Sort by Artist Name" href='#_' onclick=`getNewContent(['offset'], [['sort', 'name']]); return false;` role='button')
                                                                        i.fas.pr-2.fa-user
                                                                        | Artist Name
                                                                if (params.getAll('sort')[0] !== 'rating')
                                                                    a.dropdown-item(title="Sort by Artist Rating" href='#_' onclick=`getNewContent(['offset'], [['sort', 'rating']]); return false;` role='button')
                                                                        i.fas.pr-2.fa-face-smile
                                                                        | Artist Rating
                                                                if (params.getAll('sort')[0] !== 'eid')
                                                                    a.dropdown-item(title="Sort by most recent contribution" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['sort', 'eid']]); return false;` role='button')
                                                                        i.fas.fa-stream.pr-2
                                                                        | Date Modified
                                                                if (!(params.getAll('sort')[0] === 'random'))
                                                                    a.dropdown-item(title="Randomize" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['sort', 'random']]); return false;` role='button')
                                                                        i.fas.fa-dice.pr-2
                                                                        | Random
                                                                span.dropdown-header
                                                                    | Rating
                                                                if (!params.has('rating'))
                                                                    a.dropdown-item(title="High Artist Rating" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['rating', '0.9']]); return false;` role='button')
                                                                        i.fas.pr-2.fa-face-smile
                                                                        | High
                                                                    a.dropdown-item(title="Medium Artist Rating" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['rating', '0.75']]); return false;` role='button')
                                                                        i.fas.pr-2.fa-face-meh
                                                                        | Medium
                                                                    a.dropdown-item(title="Low Artist Rating" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['rating', '0.5']]); return false;` role='button')
                                                                        i.fas.pr-2.fa-face-frown
                                                                        | Low

                                                            else
                                                                span.dropdown-header
                                                                    | Sort
                                                                if (params.getAll('sort')[0] === 'random')
                                                                    a.dropdown-item(title="Show All" href='#_' onclick=`getNewContent(['offset'], [['sort', 'eid']])`  role='button')
                                                                        i.fas.fa-empty-set.pr-2
                                                                        | Enable Sorting
                                                                else if (params.getAll('reverse')[0] === 'true')
                                                                    a.dropdown-item(title="Sort Descending" href='#_' onclick=`getNewContent(['offset', 'reverse'${(params.getAll('sort')[0] === 'random') ? ', \'sort\'' : ''}], []); return false;` role='button')
                                                                        i.fas.fa-sort-amount-down.pr-2
                                                                        | Descending (A-Z)
                                                                else
                                                                    a.dropdown-item(title="Sort Ascending" href='#_' onclick=`getNewContent(['offset'${(params.getAll('sort')[0] === 'random') ? ', \'sort\'' : ''}], [['reverse', 'true']]); return false;` role='button')
                                                                        i.fas.fa-sort-amount-up.pr-2
                                                                        | Ascending (Z-A)
                                                                if (params.getAll('sort')[0] !== 'random')
                                                                    a.dropdown-item(title="Randomize" href='#_' onclick=`getNewContent(['offset'], [['sort', 'random']])` role='button')
                                                                        i.fas.fa-dice.pr-2
                                                                        | Random
                                                                .dropdown-divider
                                                                if (params.getAll('pins')[0] === 'false')
                                                                    a.dropdown-item(title="Show All" href='#_' onclick=`getNewContent(['offset', 'pins'], [])`  role='button')
                                                                        i.fas.fa-empty-set.pr-2
                                                                        | Show All
                                                                else
                                                                    a.dropdown-item(title="Show only not favorited" href='#_' onclick=`getNewContent(['offset'], [['pins', 'false']])` role='button')
                                                                        i.far.fa-star.pr-2
                                                                        | Unfavorited
                                                                if (params.getAll('pins')[0] === 'true')
                                                                    a.dropdown-item(title="Show All" href='#_' onclick=`getNewContent(['offset', 'pins'], [])`  role='button')
                                                                        i.fas.fa-empty-set.pr-2
                                                                        | Show All
                                                                else
                                                                    a.dropdown-item(title="Show only favorites" href='#_' onclick=`getNewContent(['offset'], [['pins', 'true']])` role='button')
                                                                        i.fas.fa-star.pr-2
                                                                        | Favorites
                                                                if (params.getAll('require_score')[0] === 'true')
                                                                    a.dropdown-item(title="Show All regardless of if tagged or scored" href='#_' onclick=`getNewContent(['offset', 'require_score'], [])`  role='button')
                                                                        i.fas.fa-empty-set.pr-2
                                                                        | Show All (Tags Only)
                                                                else
                                                                    a.dropdown-item(title="Show only items that have a MITTS Score and Tags" href='#_' onclick=`` role='button')
                                                                        i.fas.fa-tags.pr-2
                                                                        | Require Tags
                                                                if (params.getAll('cached')[0] === 'true')
                                                                    a.dropdown-item(title="Show All regardless of accessibility" href='#_' onclick=`getNewContent(['offset', 'cached'], [])`  role='button')
                                                                        i.fas.fa-cloud.pr-2
                                                                        | Any Access
                                                                else
                                                                    a.dropdown-item(title="Show only Fast Access or Directly Accessible items" href='#_' onclick=`getNewContent(['offset'], [['cached', 'true']])` role='button')
                                                                        i.fas.fa-cloud-check.pr-2
                                                                        | Fast Access
                                                                .dropdown-divider
                                                                if (params.getAll('sort')[0] !== 'random')
                                                                    if (params.getAll('sort')[0] !== 'eid')
                                                                        a.dropdown-item(title="Sort by creation" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['sort', 'eid']]); return false;` role='button')
                                                                            i.fas.fa-stream.pr-2
                                                                            | Uploaded
                                                                    if (params.getAll('sort')[0] !== 'id')
                                                                        a.dropdown-item(title="Sort by modified" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['sort', 'id']]); return false;` role='button')
                                                                            i.fas.fa-sync.pr-2
                                                                            | Modified
                                                                    if (params.getAll('sort')[0] !== 'date')
                                                                        a.dropdown-item(title="Sort by date" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['sort', 'date']]); return false;` role='button')
                                                                            i.fas.fa-file.pr-2
                                                                            | Originated
                                                                    if (!(params.getAll('sort')[0] === 'album') && params.has('album'))
                                                                        a.dropdown-item(title="Sort by date added to Album" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['sort', 'album']]); return false;` role='button')
                                                                            i.fas.fa-archive.pr-2
                                                                            | Added
                                                                    if (!(params.getAll('sort')[0] === 'fav') && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                                        a.dropdown-item(title="Sort by date Favoured" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['sort', 'fav']]); return false;` role='button')
                                                                            i.fas.fa-star.pr-2
                                                                            | Favoured
                                                                    if (!(params.getAll('sort')[0] === 'rating'))
                                                                        a.dropdown-item(title="Sort by MIITS Tag Score" href='#_' data-toggle='modal' data-target='#emiitsWarning' role='button')
                                                                            i.fas.fa-hundred-points.pr-2
                                                                            | Score (E-MIITS)
                                                                    if (!(params.getAll('sort')[0] === 'history') && (params.has('displayname') || params.getAll('history')[0] === 'only'))
                                                                        a.dropdown-item(title="Sort by date last displayed" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['sort', 'history']]); return false;` role='button')
                                                                            i.fas.fa-history.pr-2
                                                                            | Last Shown
                                                                    if (params.getAll('sort')[0] !== 'content')
                                                                        a.dropdown-item(title="Sort by message content" href='#_' onclick=`getNewContent(['offset'], [['reverse', 'true'],['sort', 'content']]); return false;` role='button')
                                                                            i.fas.fa-envelope.pr-2
                                                                            | Full Text
                                                                    if (params.getAll('sort')[0] !== 'name' && params.getAll('sort')[0] !== 'file')
                                                                        a.dropdown-item(title="Sort by File Name" href='#_' onclick=`getNewContent(['offset'], [['reverse', 'true'],['sort', 'name']]); return false;` role='button')
                                                                            i.fas.fa-input-text.pr-2
                                                                            | File Name
                                                                    if (params.getAll('sort')[0] !== 'ext')
                                                                        a.dropdown-item(title="Sort by File Extension" href='#_' onclick=`getNewContent(['offset'], [['reverse', 'true'],['sort', 'ext']]); return false;` role='button')
                                                                            i.fas.fa-photo-film-music.pr-2
                                                                            | File Extension
                                                                    if (params.getAll('sort')[0] !== 'size')
                                                                        a.dropdown-item(title="Sort by File Size" href='#_' onclick=`getNewContent(['offset', 'reverse'], [['sort', 'size']]); return false;` role='button')
                                                                            i.fas.fa-hdd.pr-2
                                                                            | File Size
                                                                if (req_uri)
                                                                    if (params && (path === '/gallery' || path === '/files' || path === '/cards'))
                                                                        span.dropdown-header
                                                                            | Date
                                                                        if (params.has('numdays') || params.has('history_numdays') || params.has('fav_numdays') || params.has('datestart') || params.has('dateend'))
                                                                            a.dropdown-item(title="Remove" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'history_numdays', 'offset'], [])`  role='button')
                                                                                i.fas.fa-empty-set.align-middle.pr-2
                                                                                | Remove
                                                                        form#dateCollapse.accordion.dropdown-item.p-0
                                                                            if (params.has('pins'))
                                                                                .div
                                                                                    #dateFavoritedRangeHeader.collapsed
                                                                                        .mb-0.mr-auto
                                                                                            button.dropdown-item(type='button' data-toggle='collapse' data-target=`#dateFavoritedRangeBody`).d-inline-flex
                                                                                                i.fas.pr-2.fa-calendar-week.align-self-center
                                                                                                span.mr-2 Range - Favoured
                                                                                                i.fas.fa-chevron-right.ml-auto.align-self-center
                                                                                    #dateFavoritedRangeBody.collapse(aria-labelledby=`dateFavoritedRangeHeader` data-parent=`#dateCollapse`)
                                                                                        div.ml-2
                                                                                            a.dropdown-item.pr-1(title="Only Today" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'history_numdays', 'offset'], [['fav_numdays', '1']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | Today
                                                                                            a.dropdown-item.pr-1(title="The last 3 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'history_numdays', 'offset'], [['fav_numdays', '3']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | 3 Days
                                                                                            a.dropdown-item.pr-1(title="The last 7 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'history_numdays', 'offset'], [['fav_numdays', '7']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | 7 Days
                                                                                            a.dropdown-item.pr-1(title="The last 15 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'history_numdays', 'offset'], [['fav_numdays', '15']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | 15 Days
                                                                                            a.dropdown-item.pr-1(title="The last 30 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'history_numdays', 'offset'], [['fav_numdays', '30']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | 30 Days
                                                                                            a.dropdown-item.pr-1(title="The last 60 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'history_numdays', 'offset'], [['fav_numdays', '60']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | 60 Days
                                                                                            a.dropdown-item.pr-1(title="The last 90 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'history_numdays', 'offset'], [['fav_numdays', '90']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | 90 Days
                                                                                            a.dropdown-item.pr-1(title="This year" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'history_numdays', 'offset'], [['fav_numdays', '360']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | This Year
                                                                            if (params.getAll('history')[0] === 'only')
                                                                                .div
                                                                                    #dateHistoryRangeHeader.collapsed
                                                                                        .mb-0.mr-auto
                                                                                            button.dropdown-item(type='button' data-toggle='collapse' data-target=`#dateHistoryRangeBody`).d-inline-flex
                                                                                                i.fas.pr-2.fa-calendar-week.align-self-center
                                                                                                span.mr-2 Range - History
                                                                                                i.fas.fa-chevron-right.ml-auto.align-self-center
                                                                                    #dateHistoryRangeBody.collapse(aria-labelledby=`dateHistoryRangeHeader` data-parent=`#dateCollapse`)
                                                                                        div.ml-2
                                                                                            a.dropdown-item.pr-1(title="Only Today" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['history_numdays', '1']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | Today
                                                                                            a.dropdown-item.pr-1(title="The last 3 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['history_numdays', '3']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | 3 Days
                                                                                            a.dropdown-item.pr-1(title="The last 7 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['history_numdays', '7']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | 7 Days
                                                                                            a.dropdown-item.pr-1(title="The last 15 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['history_numdays', '15']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | 15 Days
                                                                                            a.dropdown-item.pr-1(title="The last 30 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['history_numdays', '30']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | 30 Days
                                                                                            a.dropdown-item.pr-1(title="The last 60 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['history_numdays', '60']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | 60 Days
                                                                                            a.dropdown-item.pr-1(title="The last 90 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['history_numdays', '90']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | 90 Days
                                                                                            a.dropdown-item.pr-1(title="This year" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['history_numdays', '360']]); return false;`)
                                                                                                i.fas.fa-calendar-day.pr-2
                                                                                                | This Year
                                                                            .div
                                                                                #dateRangeHeader.collapsed
                                                                                    .mb-0.mr-auto
                                                                                        button.dropdown-item(type='button' data-toggle='collapse' data-target=`#dateRangeBody`).d-inline-flex
                                                                                            i.fas.pr-2.fa-calendar-week.align-self-center
                                                                                            | Range#{(params.getAll('history')[0] === 'only') ? ' - Items' : ''}
                                                                                            i.fas.fa-chevron-right.ml-auto.align-self-center
                                                                                #dateRangeBody.collapse(aria-labelledby=`dateRangeHeader` data-parent=`#dateCollapse`)
                                                                                    div.ml-2
                                                                                        a.dropdown-item.pr-1(title="Only Today" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['numdays', '1']]); return false;`)
                                                                                            i.fas.fa-calendar-day.pr-2
                                                                                            | Today
                                                                                        a.dropdown-item.pr-1(title="The last 3 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['numdays', '3']]); return false;`)
                                                                                            i.fas.fa-calendar-day.pr-2
                                                                                            | 3 Days
                                                                                        a.dropdown-item.pr-1(title="The last 7 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['numdays', '7']]); return false;`)
                                                                                            i.fas.fa-calendar-day.pr-2
                                                                                            | 7 Days
                                                                                        a.dropdown-item.pr-1(title="The last 15 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['numdays', '15']]); return false;`)
                                                                                            i.fas.fa-calendar-day.pr-2
                                                                                            | 15 Days
                                                                                        a.dropdown-item.pr-1(title="The last 30 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['numdays', '30']]); return false;`)
                                                                                            i.fas.fa-calendar-day.pr-2
                                                                                            | 30 Days
                                                                                        a.dropdown-item.pr-1(title="The last 60 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['numdays', '60']]); return false;`)
                                                                                            i.fas.fa-calendar-day.pr-2
                                                                                            | 60 Days
                                                                                        a.dropdown-item.pr-1(title="The last 90 days" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['numdays', '90']]); return false;`)
                                                                                            i.fas.fa-calendar-day.pr-2
                                                                                            | 90 Days
                                                                                        a.dropdown-item.pr-1(title="This year" href='#_' onclick=`getNewContent(['datestart', 'dateend', 'numdays', 'fav_numdays', 'offset'], [['numdays', '360']]); return false;`)
                                                                                            i.fas.fa-calendar-day.pr-2
                                                                                            | This Year
                                                                            .div
                                                                                #datePickerHeader.collapsed
                                                                                    .mb-0.mr-auto
                                                                                        button.dropdown-item(type='button' data-toggle='collapse' data-target=`#datePickerBody`).d-inline-flex
                                                                                            i.fas.pr-2.fa-calendar-alt.align-self-center
                                                                                            | Custom
                                                                                            i.fas.fa-chevron-right.ml-auto.align-self-center
                                                                                #datePickerBody.collapse(aria-labelledby=`datePickerHeader` data-parent=`#dateCollapse`)
                                                                                    div.ml-2
                                                                                        a.dropdown-item.pr-1(title="Select Date Range" href='#_' onclick=`$("#postRange").click(); return false;` style="width: 11em").text-ellipsis.d-inline-flex
                                                                                            .pr-2
                                                                                                i.fas.fa-calendar-day
                                                                                            div
                                                                                                span#dateText
                                                                    if (params && (path === '/gallery' || path === '/cards'))
                                                                        span.dropdown-header
                                                                            | Resolution
                                                                            if (params.has('minres'))
                                                                                span.pl-1 (#{params.getAll('minres')[0]}px)
                                                                        if (params.has('minhres') || params.has('minwres') || params.has('minres'))
                                                                            a.dropdown-item(title="Show all image resolutions" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], []); return false;`)
                                                                                i.fas.fa-empty-set.pr-2
                                                                                | Reset Filter
                                                                        form#resolution2Collapse.accordion.dropdown-item.p-0
                                                                            .div
                                                                                #resolution2WidthHeader.collapsed
                                                                                    .mb-0.mr-auto
                                                                                        button.dropdown-item(type='button' data-toggle='collapse' data-target=`#resolution2WidthBody`).d-inline-flex
                                                                                            i.fas.pr-2.fa-ruler-horizontal.align-self-center
                                                                                            | Horizontal
                                                                                            i.fas.fa-chevron-right.ml-auto.align-self-center
                                                                                #resolution2WidthBody.collapse(aria-labelledby=`resolution2WidthHeader` data-parent=`#resolution2Collapse`)
                                                                                    div.ml-2
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 720px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minwres', '720']]); return false;`)
                                                                                            i.fas.fa-ruler-horizontal.pr-2
                                                                                            | HQ (720px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 720px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minwres', '900']]); return false;`)
                                                                                            i.fas.fa-ruler-horizontal.pr-2
                                                                                            | HQ (900px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 1080px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minwres', '1000']]); return false;`)
                                                                                            i.fas.fa-ruler-horizontal.pr-2
                                                                                            | HD (1000px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 2000px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minwres', '2000']]); return false;`)
                                                                                            i.fas.fa-ruler-horizontal.pr-2
                                                                                            | 2K (2000px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 3000px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minwres', '3000']]); return false;`)
                                                                                            i.fas.fa-ruler-horizontal.pr-2
                                                                                            | 3K (3000px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 4000px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minwres', '4000']]); return false;`)
                                                                                            i.fas.fa-ruler-horizontal.pr-2
                                                                                            | 4K (4000px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 5000px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minwres', '5000']]); return false;`)
                                                                                            i.fas.fa-ruler-horizontal.pr-2
                                                                                            | 5K (5000px+)
                                                                            .div
                                                                                #resolution2HeightHeader.collapsed
                                                                                    .mb-0.mr-auto
                                                                                        button.dropdown-item(type='button' data-toggle='collapse' data-target=`#resolution2HeightBody`).d-inline-flex
                                                                                            i.fas.pr-2.fa-ruler-vertical.align-self-center
                                                                                            | Vertical
                                                                                            i.fas.fa-chevron-right.ml-auto.align-self-center
                                                                                #resolution2HeightBody.collapse(aria-labelledby=`resolution2HeightHeader` data-parent=`#resolution2Collapse`)
                                                                                    div.ml-2
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 720px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minhres', '720']]); return false;`)
                                                                                            i.fas.fa-ruler-vertical.pr-2
                                                                                            | HQ (720px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 720px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minhres', '900']]); return false;`)
                                                                                            i.fas.fa-ruler-vertical.pr-2
                                                                                            | HQ (900px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 1080px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minhres', '1000']]); return false;`)
                                                                                            i.fas.fa-ruler-vertical.pr-2
                                                                                            | HD (1000px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 2000px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minhres', '2000']]); return false;`)
                                                                                            i.fas.fa-ruler-vertical.pr-2
                                                                                            | 2K (2000px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 3000px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minhres', '3000']]); return false;`)
                                                                                            i.fas.fa-ruler-vertical.pr-2
                                                                                            | 3K (3000px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 4000px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minhres', '4000']]); return false;`)
                                                                                            i.fas.fa-ruler-vertical.pr-2
                                                                                            | 4K (4000px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 5000px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minhres', '5000']]); return false;`)
                                                                                            i.fas.fa-ruler-vertical.pr-2
                                                                                            | 5K (5000px+)
                                                                            .div
                                                                                #resolution2CombindedHeader.collapsed
                                                                                    .mb-0.mr-auto
                                                                                        button.dropdown-item(type='button' data-toggle='collapse' data-target=`#resolution2CombindedBody`).d-inline-flex
                                                                                            i.fas.pr-2.fa-ruler-combined.align-self-center
                                                                                            | Loose
                                                                                            i.fas.fa-chevron-right.ml-auto.align-self-center
                                                                                #resolution2CombindedBody.collapse(aria-labelledby=`resolution2CombindedHeader` data-parent=`#resolution2Collapse`)
                                                                                    div.ml-2
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 720px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minres', '720']]); return false;`)
                                                                                            i.fas.fa-ruler-combined.pr-2
                                                                                            | HQ (720px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 720px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minres', '900']]); return false;`)
                                                                                            i.fas.fa-ruler-combined.pr-2
                                                                                            | HQ (900px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 1080px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minres', '1000']]); return false;`)
                                                                                            i.fas.fa-ruler-combined.pr-2
                                                                                            | HD (1000px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 2000px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minres', '2000']]); return false;`)
                                                                                            i.fas.fa-ruler-combined.pr-2
                                                                                            | 2K (2000px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 3000px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minres', '3000']]); return false;`)
                                                                                            i.fas.fa-ruler-combined.pr-2
                                                                                            | 3K (3000px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 4000px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minres', '4000']]); return false;`)
                                                                                            i.fas.fa-ruler-combined.pr-2
                                                                                            | 4K (4000px+)
                                                                                        a.dropdown-item.pr-1(title="Show images larger then 5000px" href='#_' onclick=`getNewContent(['offset', 'minwres', 'minhres', 'minres'], [['minres', '5000']]); return false;`)
                                                                                            i.fas.fa-ruler-combined.pr-2
                                                                                            | 5K (5000px+)
                                                                        span.dropdown-header
                                                                            | Aspect Ratio
                                                                            if (params.has('ratio'))
                                                                                span.pl-1 (#{params.getAll('ratio')[0]})
                                                                        if (params.has('ratio'))
                                                                            a.dropdown-item(title="Show all Aspect Ratios" href='#_' onclick=`getNewContent(['offset', 'ratio'], []); return false;`)
                                                                                i.fas.fa-empty-set.pr-2
                                                                                | Remove
                                                                        form#ratio2Collapse.accordion.dropdown-item.p-0
                                                                            .div
                                                                                #ratio2LooseHeader.collapsed
                                                                                    .mb-0.mr-auto
                                                                                        button.dropdown-item(type='button' data-toggle='collapse' data-target=`#ratio2LooseBody`).d-inline-flex
                                                                                            i.fas.pr-2.fa-expand-arrows-alt.align-self-center
                                                                                            | Loose
                                                                                            i.fas.fa-chevron-right.ml-auto.align-self-center
                                                                                #ratio2LooseBody.collapse(aria-labelledby=`ratio2LooseHeader` data-parent=`#ratio2Collapse`)
                                                                                    div.ml-2
                                                                                        a.dropdown-item.pr-1(title="Show only Portrait Images" href='#_' onclick=`getNewContent(['offset', 'ratio'], [['ratio', '0.85-2.1']]); return false;`)
                                                                                            | Portrait
                                                                                        a.dropdown-item.pr-1(title="Show only Square Images" href='#_' onclick=`getNewContent(['offset', 'ratio'], [['ratio', '0.8-1.2']]); return false;`)
                                                                                            | Square
                                                                                        a.dropdown-item.pr-1(title="Show only Widescreen Images" href='#_' onclick=`getNewContent(['offset', 'ratio'], [['ratio', '0.01-1']]); return false;`)
                                                                                            | Widescreen
                                                                            .div
                                                                                #ratio2StrictHeader.collapsed
                                                                                    .mb-0.mr-auto
                                                                                        button.dropdown-item(type='button' data-toggle='collapse' data-target=`#ratio2StrictBody`).d-inline-flex
                                                                                            i.fas.pr-2.fa-expand-arrows-alt.align-self-center
                                                                                            | Strict
                                                                                            i.fas.fa-chevron-right.ml-auto.align-self-center
                                                                                #ratio2StrictBody.collapse(aria-labelledby=`ratio2StrictHeader` data-parent=`#ratio2Collapse`)
                                                                                    div.ml-2
                                                                                        a.dropdown-item.pr-1(title="Show only Portrait Images" href='#_' onclick=`getNewContent(['offset', 'ratio'], [['ratio', '1.1-2.1']]); return false;`)
                                                                                            | Portrait
                                                                                        a.dropdown-item.pr-1(title="Show only 3:4 Images" href='#_' onclick=`getNewContent(['offset', 'ratio'], [['ratio', '1.32-1.34']]); return false;`)
                                                                                            | Photo (3:4)
                                                                                        a.dropdown-item.pr-1(title="Show only 9:16 Images" href='#_' onclick=`getNewContent(['offset', 'ratio'], [['ratio', '1.76-1.78']]); return false;`)
                                                                                            | Wallpaper (9:16)
                                                                                        .dropdown-divider.mt-1.mb-1
                                                                                        a.dropdown-item.pr-1(title="Show only Square Images" href='#_' onclick=`getNewContent(['offset', 'ratio'], [['ratio', '0.90-1.15']]); return false;`)
                                                                                            | Square
                                                                                        .dropdown-divider.mt-1.mb-1
                                                                                        a.dropdown-item.pr-1(title="Show only Widescreen Images" href='#_' onclick=`getNewContent(['offset', 'ratio'], [['ratio', '0.01-0.9']]); return false;`)
                                                                                            | Widescreen
                                                                                        a.dropdown-item.pr-1(title="Show only 4:3 Images" href='#_' onclick=`getNewContent(['offset', 'ratio'], [['ratio', (3/4).toString()]]); return false;`)
                                                                                            | Photo (4:3)
                                                                                        a.dropdown-item.pr-1(title="Show only 16:9 Images" href='#_' onclick=`getNewContent(['offset', 'ratio'], [['ratio', (9/16).toString()]]); return false;`)
                                                                                            | Wallpaper (16:9)
                                                                            .div
                                                                                #ratio2CustomHeader.collapsed
                                                                                    .mb-0.mr-auto
                                                                                        button.dropdown-item(type='button' data-toggle='collapse' data-target=`#ratio2CustomBody`).d-inline-flex
                                                                                            i.fas.pr-2.fa-expand-arrows-alt.align-self-center
                                                                                            | Custom
                                                                                            i.fas.fa-chevron-right.ml-auto.align-self-center
                                                                                #ratio2CustomBody.collapse(aria-labelledby=`ratio2CustomHeader` data-parent=`#ratio2Collapse`)
                                                                                    div.dropdown-item
                                                                                        input#ratio2Slider.span2(type='text' value='' data-slider-min='0' data-slider-mid='1' data-slider-max='3' data-slider-step='0.01' data-slider-range='true' data-slider-value=sliderDefaults data-slider-reversed="true" data-tooltip='show' data-slider-lock-to-ticks="false" data-slider-ticks-snap-bounds="0.01" data-slider-ticks="[0, 1, 3]")
                                                                                        div.d-flex.pt-2
                                                                                            span P
                                                                                            span.mr-auto.ml-auto S
                                                                                            span L
                                                                                        div.d-flex
                                                                                            a(type='button' title="Apply Range" href='#_' onclick=`applyRangeSelection2(); return false;`)
                                                                                                i.fas.fa-check.pr-2
                                                                                                | Apply
                                                                                        script.
                                                                                            $("#ratio2Slider").slider({id: 'rangeSlider'});
                                                                                            function applyRangeSelection2() {
                                                                                                const _rI = $('#ratio2Slider').slider()[0].value.split(',')
                                                                                                getNewContent(['offset', 'ratio'], [['ratio', `${_rI.join('-')}`]])
                                                                                            }

                                                                        span.dropdown-header
                                                                            | Colour
                                                                        if (params.has('dark'))
                                                                            a.dropdown-item(title="Show both light and dark images" href='#_' onclick=`getNewContent(['offset', 'dark'], []); return false;`)
                                                                                i.fas.fa-empty-set.pr-2
                                                                                | Reset Filter
                                                                        if (params.getAll('dark')[0] !== 'false')
                                                                            a.dropdown-item(title="Show only bright images" href='#_' onclick=`getNewContent(['offset'], [['dark', 'false']]); return false;`)
                                                                                i.fas.fa-sun.pr-2
                                                                                | Light
                                                                        if (params.getAll('dark')[0] !== 'true')
                                                                            a.dropdown-item(title="Show only dark images" href='#_' onclick=`getNewContent(['offset'], [['dark', 'true']]); return false;`)
                                                                                i.fas.fa-moon.pr-2
                                                                                | Dark
                                                                        form#colorCollapse.accordion.dropdown-item.p-0
                                                                            .div
                                                                                #colorLooseHeader.collapsed
                                                                                    .mb-0.mr-auto
                                                                                        button.dropdown-item(type='button' data-toggle='collapse' data-target=`#colorLooseBody`).d-inline-flex
                                                                                            i.fas.pr-2.fa-swatchbook.align-self-center
                                                                                            | Colour Range
                                                                                            i.fas.fa-chevron-right.ml-auto.align-self-center
                                                                                #colorLooseBody.collapse(aria-labelledby=`colorLooseHeader` data-parent=`#colorCollapse`)
                                                                                    .dropdown-item
                                                                                        input#colorRSlider.span2(type='text' value='' data-slider-min='0' data-slider-mid='128' data-slider-max='255' data-slider-step='1' data-slider-range='true' data-slider-value=sliderColorsDefaults[0] data-tooltip='show' data-slider-lock-to-ticks="false" data-slider-ticks-snap-bounds="15" data-slider-ticks="[0, 128, 255]")
                                                                                        input#colorGSlider.span2(type='text' value='' data-slider-min='0' data-slider-mid='128' data-slider-max='255' data-slider-step='1' data-slider-range='true' data-slider-value=sliderColorsDefaults[1] data-tooltip='show' data-slider-lock-to-ticks="false" data-slider-ticks-snap-bounds="15" data-slider-ticks="[0, 128, 255]")
                                                                                        input#colorBSlider.span2(type='text' value='' data-slider-min='0' data-slider-mid='128' data-slider-max='255' data-slider-step='1' data-slider-range='true' data-slider-value=sliderColorsDefaults[2] data-tooltip='show' data-slider-lock-to-ticks="false" data-slider-ticks-snap-bounds="15" data-slider-ticks="[0, 128, 255]")
                                                                                        div.d-flex
                                                                                            a(type='button' title="Apply Range" href='#_' onclick=`applyColorRangeSelection(); return false;`)
                                                                                                i.fas.fa-check.pr-2
                                                                                                | Apply
                                                                                        script.
                                                                                            $("#colorRSlider").slider({id: "colorSliderR"});
                                                                                            $("#colorGSlider").slider({id: "colorSliderG"});
                                                                                            $("#colorBSlider").slider({id: "colorSliderB"});
                                                                                            function applyColorRangeSelection() {
                                                                                                const _cR = $('#colorRSlider').slider()[0].value.split(',').join('-')
                                                                                                const _cG = $('#colorGSlider').slider()[0].value.split(',').join('-')
                                                                                                const _cB = $('#colorBSlider').slider()[0].value.split(',').join('-')
                                                                                                getNewContent(['offset', 'ratio'], [['color', `${_cR}:${_cG}:${_cB}`]])
                                                                                            }
                                                                        span.dropdown-header
                                                                            | Advanced
                                                                        a.dropdown-item(title="Show Artists from here" href='#_' onclick=`getNewContent([], [${(params.has('channel')) ? '["channel", "' + params.getAll('channel')[0] + '"]' : (params.has('folder')) ? '["folder", "' + params.getAll('folder')[0] + '"]' : ''}], '/artists', true); return false;`)
                                                                            i.fas.fa-address-book.pr-2
                                                                            | Artists
                                            if (results && params && !(results.length === 1 && path === '/gallery' && search_prev && search_prev !== ''))
                                                a.navbar-item.btn.btn-ice.py-0.px-2.show-menu-open.hidden(data-toggle='collapse' href='#_' role='button' aria-expanded='false' data-target='#showResultsWarningsFull')
                                                    i.far.fa-info-circle
                                        li.nav-item.no-arrow.hidden.done-btns
                                            if (results && (params && (path === '/gallery' || path === '/files' || path === '/cards')) && results.length > 1)
                                                .btn-group
                                                    a.navbar-item.btn.btn-admin(title="Cancel Selection" href='#_' onclick='disableGallerySelect(); clearactionModel(); ;return false;')
                                                        i.far.fa-times-circle.align-middle

                                                    a#selectAll1.navbar-item.btn.btn-admin.pr-2(title="Select All" href='#_' onclick='selectAllPoststoMode(); return false;')
                                                        i.far.fa-check-square.align-middle
                                                    a#deSelectAll1.navbar-item.btn.btn-admin.pr-2(title="Deselect All" href='#_' onclick='deselectAllPoststoMode(); return false;').hidden
                                                        i.far.fa-check-square.align-middle

                                                    if (enableManageTools)
                                                        a.navbar-item.btn.btn-admin(title="Manage Messages" href='#_' onclick='openActionMenu(true); return false;')
                                                            i.far.fa-paste.align-middle
                                                    a.navbar-item.btn.btn-admin(title="Offline Messages" href='#_' onclick='offlineSelectedItems(); return false;')
                                                        i.far.fa-bookmark.align-middle
                                                    a.navbar-item.btn.btn-admin(title="Download Messages" href='#_' onclick='downloadSelectedItems(); return false;')
                                                        i.far.fa-download.align-middle
                                if (!(params.has('responseType') && params.getAll('responseType')[0] === 'offline'))
                                    ul#loadingSpinner.navbar-nav.text-primary.text-ellipsis(style='display: none;')
                                        li.nav-item.no-arrow
                                            i.fas.fa-spinner.fa-spin-pulse
                                ul.navbar-nav.text-primary.ml-1.d-none.d-sm-block
                                    li#infoHolder.nav-item.text-right.page-title.text-primary
                                        span.badge.bg-translucent.push-up.px-1
                                            if (path === '/artists')
                                                if (params.getAll('reverse')[0] === 'true')
                                                    i.fas.fa-sort-amount-up.px-1
                                                if (params.getAll('sort')[0] === 'count')
                                                    i.fas.px-1.fa-calculator
                                                if (params.getAll('sort')[0] === 'name')
                                                    i.fas.px-1.fa-user
                                                if (params.getAll('sort')[0] === 'rating')
                                                    i.fas.px-1.fa-face-smile
                                                if (params.getAll('sort')[0] === 'eid')
                                                    i.fas.fa-stream.px-1
                                                if ((params.getAll('sort')[0] === 'random'))
                                                    i.fas.fa-dice.px-1
                                                if (params.has('rating'))
                                                    i.fas.px-1.fa-face-smile
                                            else
                                                if (params.getAll('pins')[0] === 'false')
                                                    i.far.fa-star.px-1
                                                if (params.getAll('pins')[0] === 'true')
                                                    i.fas.fa-star.px-1
                                                if (params.getAll('require_score')[0] === 'true')
                                                    i.fas.fa-binary.px-1
                                                if (params.getAll('cached')[0] === 'true')
                                                    i.fas.fa-cloud-check.px-1
                                                if (params.getAll('reverse')[0] === 'true')
                                                    i.fas.fa-sort-amount-up.px-1
                                                if (params.getAll('sort')[0] === 'eid')
                                                    i.fas.fa-stream.px-1
                                                if (params.getAll('sort')[0] === 'id')
                                                    i.fas.fa-pencil.px-1
                                                if (params.getAll('sort')[0] === 'date')
                                                    i.fas.fa-file.px-1
                                                if (params.getAll('sort')[0] === 'album')
                                                    i.fas.fa-archive.px-1
                                                if (!(params.getAll('sort')[0] === 'fav') && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                    i.fas.fa-star.px-1
                                                if (params.getAll('sort')[0] === 'rating')
                                                    i.fas.fa-hundred-points.px-1
                                                if (params.getAll('sort')[0] === 'history' && (params.has('displayname') || params.getAll('history')[0] === 'only'))
                                                    i.fas.fa-history.px-1
                                                if (params.getAll('sort')[0] === 'content')
                                                    i.fas.fa-envelope.px-1
                                                if (params.getAll('sort')[0] === 'name' || params.getAll('sort')[0] === 'file')
                                                    i.fas.fa-input-text.px-1
                                                if (params.getAll('sort')[0] === 'ext')
                                                    i.fas.fa-photo-film-music.px-1
                                                if (params.getAll('sort')[0] === 'size')
                                                    i.fas.fa-hdd.px-1
                                                if (req_uri)
                                                    if (params && (path === '/gallery' || path === '/files' || path === '/cards'))
                                                        if (params.has('numdays') || params.has('history_numdays') || params.has('fav_numdays') || params.has('datestart') || params.has('dateend'))
                                                            i.fas.px-1.fa-calendar-week
                                                    if (params && (path === '/gallery' || path === '/cards'))
                                                        if (params.has('minhres') || params.has('minwres') || params.has('minres'))
                                                            i.fas.px-1.fa-ruler-combined
                                                        if (params.has('ratio'))
                                                            i.fas.px-1.fa-expand-arrows-alt
                                                        if (params.getAll('dark')[0] === 'false')
                                                            i.fas.fa-sun.px-1
                                                        if (params.getAll('dark')[0] === 'true')
                                                            i.fas.fa-moon.px-1
                                                        if (params.has('color'))
                                                            .fas.px-1.fa-swatchbook
                                            if (params.has('nsfw'))
                                                i.fas.fa-exclamation-triangle.px-1(title=`NSFW Results Enabled`)
                                            if (ultraCache)
                                                i.fas.fa-bolt.px-1(title=`UltraCache - ${ultraCache}m`)
                                            else
                                                i.fas.fa-wave-triangle.px-1(title="UltraCache is processing...")

                            .col-auto.p-0.d-flex
                                ul.navbar-nav.text-primary.text-ellipsis.w-100
                                    li.nav-item.no-arrow.kms-pip-icons.align-items-center
                                        .badge.d-none.d-flex.align-items-center.ml-1.my-1
                                            a.navbar-item.btn.btn-ice.px-1.py-0(data-toggle='collapse' href='#_' role='button' onclick="kongouPIPVideo(); return false;")
                                                i.fas.fa-ticket
                                            a.navbar-item.btn.btn-ice.px-1.py-0.d-none.d-sm-block(data-toggle='collapse' href='#_' role='button' onclick="getNewContent([],[], kongouMediaActiveURL); return false;")
                                                i.fas.fa-list
                                            a.navbar-item.btn.btn-ice.px-1.py-0.d-none.d-sm-block(data-toggle='collapse' href='#_' role='button' onclick="kmsSeek(false, 15); return false;")
                                                i.fas.fa-arrow-rotate-right
                                            a.navbar-item.btn.btn-ice.px-1.py-0(data-toggle='collapse' href='#_' role='button' onclick="kmsPlayNext(); return false;")
                                                i.fas.fa-forward-fast
                                    li.nav-item.no-arrow.align-items-center.ml-1.performance-mode-icon
                                        a.align-items-center.d-flex(title="Disable Performance Mode" href='#_' onClick=`disablePerformanceMode(); return false;`)
                                            i.fas.fa-bolt
                                    li.nav-item.no-arrow.d-flex.align-items-center
                                        a.userDropdown.align-items-center.d-flex.collapsed(title="User Account and Settings" href='#_' data-toggle="collapse" aria-haspopup='true' aria-expanded='false' data-target='#userMenu' onClick=`$('#menuMainItem1').collapse('show')`)
                                            i.far.fa-bars.pl-2
                                            img.img-profile.rounded-circle(src=user.avatar)

                        //div#topbarAccent.show-menu-open.hidden
                        div#topbarUserBackground.show-menu-open.hidden
                            div.user-info-backdrop
                        div#topbarIcon.show-menu-open.hidden.d-none
                        div#topbarKmsIcon.show-menu-open.hidden.d-none
                        div#topbarBackground
                            //(style='display: none;')

                    .container-fluid.max-resize(class=`${(path === '/listTheater' && params.has('show_id')) ? 'thin-width' : ''}`)
                        #hiddenItemsAlert.alert.alert-danger-transparent.hidden(role="alert")
                            .row
                                .col-auto.align-self-start.align-self-center
                                    .glyphicon
                                        i.fas.fa-empty-set.text-danger
                                .align-self-start.align-self-center
                                    .text-danger There are actions pending and are hidden from results
                        if (!(results && results.length === 1 && path === '/gallery' && search_prev && search_prev !== ''))
                            #showResultsWarningsFull.collapse
                                if (search_prev || search_prev === '')
                                    .alert.alert-info-darktrans.w-100(role="alert")
                                        .row
                                            .col-auto.align-self-start.align-self-center.pl-1
                                                if (active_svr)
                                                    - servericon = discord.servers.list.filter(e => e.serverid === active_svr).map(e => e.icon)
                                                    if (servericon && servericon.length > 0)
                                                        - servericon = servericon.pop()
                                                    else
                                                        - servericon = null
                                                if (servericon)
                                                    img.align-self-center.rounded(src=servericon style='height: 7rem;')
                                                else
                                                    .glyphicon.pl-1
                                                        i.fas.fa-directions.text-info
                                            .col
                                                if (!title || title === '')
                                                    if (params && (params.getAll('channel')[0] === 'random' || !(params.has('channel') || params.has('folder') || params.has('album') || params.has('album_name'))))
                                                        if (params && path === '/artists')
                                                            div.row.text-lg
                                                                div
                                                                    | Artist Index
                                                            div.row
                                                                div
                                                                    | Index of Artists throughout the database
                                                        else if (params && params.getAll('sort')[0] === 'random')
                                                            div.row.text-lg
                                                                div
                                                                    | I'm Feeling Lucky
                                                            div.row
                                                                div
                                                                    | Random selection of items from the server
                                                        else if (params && params.getAll('sort')[0] === 'fav')
                                                            div.row.text-lg
                                                                div
                                                                    | Favorites
                                                            div.row
                                                                div
                                                                    | Favoured Items
                                                        else if (params.has('color'))
                                                            div.row.text-lg
                                                                div
                                                                    | Colour search
                                                            div.row
                                                                div
                                                                    | Images by there averaged colour
                                                        else if (params.has('displayname'))
                                                            div.row.text-lg
                                                                div
                                                                    | History
                                                            div.row
                                                                div
                                                                    | History for #{params.getAll('displayname')[0]}
                                                        else if (params && (params.getAll('sort')[0] === 'id' || params.getAll('sort')[0] === 'eid'))
                                                            if (params && params.has('pins') && params.getAll('pins')[0] !== 'false')
                                                                div.row.text-lg
                                                                    div
                                                                        | Favorites
                                                                div.row
                                                                    div
                                                                        | Favoured Items
                                                            else
                                                                if (path === '/files')
                                                                    div.row.text-lg
                                                                        div
                                                                            | Latest Files
                                                                    div.row
                                                                        div
                                                                            | Files in order of upload
                                                                else
                                                                    div.row.text-lg
                                                                        div
                                                                            | Latest Media
                                                                    div.row
                                                                        div
                                                                            | Images in order of upload
                                                        else if (search_prev && search_prev !== '')
                                                            div.row.text-lg
                                                                div
                                                                    | Search Results
                                                            div.row
                                                                div
                                                                    if (search_prev.includes(" AND "))
                                                                        - _and = search_prev.split(' AND ')
                                                                        | Results for
                                                                        each andSearch, andIndex in _and
                                                                            if (andSearch.includes(" OR "))
                                                                                - _or = andSearch.split(' OR ')
                                                                                each orSearch, orIndex in _or
                                                                                    | '#{orSearch}'
                                                                                    if (orIndex + 1 !== _or.length)
                                                                                        | or
                                                                            else
                                                                                | '#{andSearch}'
                                                                            if (andIndex + 1 !== _and.length)
                                                                                | and
                                                                    else if (search_prev.includes(" OR "))
                                                                        - _or = search_prev.split(' OR ')
                                                                        | Results for
                                                                        each orSearch, orIndex in _or
                                                                            | '#{orSearch}'
                                                                            if (orIndex + 1 !== _or.length)
                                                                                | or
                                                                    else
                                                                        | Results for '#{search_prev}'
                                                        else
                                                            div.row.text-lg
                                                                div
                                                                    | Recents
                                                            div.row
                                                                div
                                                                    | Images in chronologically order
                                                    else
                                                        div.row.text-lg
                                                            div
                                                                | No Description Available
                                                else
                                                    if (full_title_post)
                                                        div.row.text-lg
                                                            div
                                                                | #{full_title_post}
                                                    if (folderInfo)
                                                        div.row
                                                            div.pr-2
                                                                | Folder Path:
                                                            div
                                                                span#folderPath #{folderInfo}
                                                    if (description)
                                                        div.row
                                                            div.pr-2
                                                                | Description:
                                                            div
                                                                | #{description}
                                                    if (params && params.has('album'))
                                                        - const albumID = params.getAll('album')[0];
                                                        div.row
                                                            div.pr-2
                                                                | Album ID:
                                                            div
                                                                | #{albumID}
                                if (params && params.has('pins') && params.getAll('pins')[0] !== 'false' && params.getAll('pins')[0] !== 'true' && params.getAll('pins')[0] !== 'false')
                                    .alert.alert-time-transparent(role="alert")
                                        .row
                                            .col-auto.align-self-start.align-self-center
                                                .glyphicon
                                                    i.fas.fa-star.text-warning
                                            .align-self-start.align-self-center
                                                .text-warning Showing Favorites for user ID : #{params.getAll('pins')[0]}
                                if (params && params.has('cached') && params.getAll('cached')[0] === 'true')
                                    .alert.alert-time-transparent(role="alert")
                                        .row
                                            .col-auto.align-self-start.align-self-center
                                                .glyphicon
                                                    i.fas.fa-cloud-check.text-warning
                                            .align-self-start.align-self-center
                                                .text-warning Showing only Fast Access or Directly Accessible items
                                            .align-self-center.align-self-start.ml-auto.mr-1
                                                a.text-warning.align-self-end.alert-btn(title="Remove Accessibility Requirements" href='#_' onclick=`getNewContent(['offset', 'cached'], []); return false;`) Show All
                                if (params && params.has('history_numdays'))
                                    - const days = parseInt(params.getAll('history_numdays')[0]);
                                    .alert.alert-time-transparent(role="alert")
                                        .row
                                            .col-auto.align-self-start.align-self-center
                                                .glyphicon
                                                    i.fas.fa-history.text-warning
                                            .align-self-start.align-self-center
                                                .text-warning.d-none.d-sm-inline History from the last #{days} Days
                                                .text-warning.d-sm-none #{days} Days
                                            .align-self-center.align-self-start.ml-auto.mr-1
                                                a.text-warning.align-self-end.alert-btn(title="Remove Date Range" href='#_' onclick=`getNewContent(['offset', 'fav_numdays', 'history_numdays', 'numdays'], []); return false;`) Show All
                                if (params && params.has('fav_numdays'))
                                    - const days = parseInt(params.getAll('fav_numdays')[0]);
                                    .alert.alert-time-transparent(role="alert")
                                        .row
                                            .col-auto.align-self-start.align-self-center
                                                .glyphicon
                                                    i.fas.fa-history.text-warning
                                            .align-self-start.align-self-center
                                                .text-warning.d-none.d-sm-inline Favorites from the last #{days} Days
                                                .text-warning.d-sm-none #{days} Days
                                            .align-self-center.align-self-start.ml-auto.mr-1
                                                a.text-warning.align-self-end.alert-btn(title="Remove Date Range" href='#_' onclick=`getNewContent(['offset', 'fav_numdays', 'history_numdays', 'numdays'], []); return false;`) Show All
                                if (params && params.has('numdays'))
                                    - const days = parseInt(params.getAll('numdays')[0]);
                                    .alert.alert-time-transparent(role="alert")
                                        .row
                                            .col-auto.align-self-start.align-self-center
                                                .glyphicon
                                                    i.fas.fa-clock.text-warning
                                            .align-self-start.align-self-center
                                                .text-warning.d-none.d-sm-inline Results shown are from the last #{days} Days
                                                .text-warning.d-sm-none #{days} Days
                                            .align-self-center.align-self-start.ml-auto.mr-1
                                                a.text-warning.align-self-end.alert-btn(title="Remove Date Range" href='#_' onclick=`getNewContent(['offset', 'fav_numdays', 'history_numdays', 'numdays'], []); return false;`) Show All
                                else if (params && params.has('datestart'))
                                    - const datestart = params.getAll('datestart')[0]
                                    - const dateend = params.getAll('dateend')[0]
                                    .alert.alert-time-transparent(role="alert")
                                        .row
                                            .col-auto.align-self-start.align-self-center
                                                .glyphicon
                                                    i.fas.fa-clock.text-warning
                                            .align-self-start.align-self-center
                                                .text-warning.d-none.d-sm-inline Results shown are from #{datestart} to #{dateend}
                                                .text-warning.d-sm-none #{datestart} - #{dateend}
                                            .align-self-center.align-self-start.ml-auto.mr-1
                                                a.text-warning.align-self-end.alert-btn(title="Remove Date Range" href='#_' onclick=`getNewContent(['offset', 'fav_numdays', 'history_numdays', 'numdays', 'datestart', 'dateend'], []); return false;`) Show All
                                if (params.has('minres') || params.has('minhres') || params.has('minwres'))
                                    .alert.alert-time-transparent(role="alert")
                                        .row
                                            .col-auto.align-self-start.align-self-center
                                                .glyphicon
                                                    i.fas.text-warning.fa-ruler-combined
                                            .align-self-start.align-self-center
                                                if (params.has('minres'))
                                                    .text-warning.d-none.d-sm-inline Minimum Loose Resolution of #{params.getAll('minres')[0]}px
                                                    .text-warning.d-sm-none Min Res: #{params.getAll('minres')[0]}px
                                                else if (params.has('minhres'))
                                                    .text-warning.d-none.d-sm-inline Minimum Vertical Resolution of #{params.getAll('minhres')[0]}px
                                                    .text-warning.d-sm-none Min Vert: #{params.getAll('minhres')[0]}px
                                                else if (params.has('minwres'))
                                                    .text-warning.d-none.d-sm-inline Minimum Horizontal Resolution of #{params.getAll('minwres')[0]}px
                                                    .text-warning.d-sm-none Min Horiz: #{params.getAll('minwres')[0]}px
                                            .align-self-center.align-self-start.ml-auto.mr-1
                                                a.text-warning.align-self-end.alert-btn(title="Remove Minimum Pixel Range" href='#_' onclick=`getNewContent(['offset', 'minres', 'minhres', 'minwres'], []); return false;`) Show All
                                if (params.has('ratio'))
                                    .alert.alert-time-transparent(role="alert")
                                        .row
                                            .col-auto.align-self-start.align-self-center
                                                .glyphicon
                                                    i.fas.text-warning.fa-ruler-combined
                                            .align-self-start.align-self-center
                                                - ratio = params.getAll('ratio')[0]
                                                if (ratio !== '0.01-1')
                                                    .text-warning Landscape Images
                                                else if (ratio === '0.85-2.1')
                                                    .text-warning Portrait Images
                                                else if (ratio === '1.1-2.1')
                                                    .text-warning Strictly Portrait Images
                                                else if (ratio === '0.01-0.9')
                                                    .text-warning Strictly Landscape Images
                                                else
                                                    .text-warning Custom Aspect Ratio Range: #{params.getAll('ratio')[0]}
                                            .align-self-center.align-self-start.ml-auto.mr-1
                                                a.text-warning.align-self-end.alert-btn(title="Remove Ratio Range" href='#_' onclick=`getNewContent(['offset', 'ratio'], []); return false;`) Show All
                                if (params.has('dark'))
                                    .alert.alert-time-transparent(role="alert")
                                        .row
                                            .col-auto.align-self-start.align-self-center
                                                .glyphicon
                                                    i.fas.text-warning.fa-adjust
                                            .align-self-start.align-self-center
                                                if (params.getAll('dark')[0] === 'false')
                                                    .text-warning Light Images
                                                else if (params.getAll('dark')[0] === 'true')
                                                    .text-warning Dark Images
                                            .align-self-center.align-self-start.ml-auto.mr-1
                                                a.text-warning.align-self-end.alert-btn(title="Remove Brightness Filter" href='#_' onclick=`getNewContent(['offset', 'dark'], []); return false;`) Show All
                                if (params.has('color'))
                                    .alert.alert-time-transparent.text-warning(role="alert")
                                        .row
                                            .col-auto.align-self-start.align-self-center
                                                .glyphicon
                                                    i.fas.fa-swatchbook
                                            .align-self-start.align-self-center
                                                if (simularColor)
                                                    .d-inline-flex
                                                        span.align-self-center.d-none.d-sm-inline Similar Colour
                                                        div.ml-1.color-preview.align-self-center(style=`background-color: ${simularColor}`)
                                                        a.text-warning.align-self-center.alert-btn.ml-2(title="Advanced" href='#_' type='button' data-toggle='collapse' data-target='#advancedColorOptions') Advanced
                                                else
                                                    .d-none.d-sm-inline Colour Range: R=#{sliderColorsDefaults[0]} G=#{sliderColorsDefaults[1]} B=#{sliderColorsDefaults[2]}
                                                    .d-sm-none Custom Colour Range
                                            .align-self-center.align-self-start.ml-auto.mr-1
                                                a.text-warning.align-self-end.alert-btn(title="Remove Colour Filter" href='#_' onclick=`getNewContent(['offset', 'color'], []); return false;`) Show All
                                        if (simularColor)
                                            #advancedColorOptions.collapse.mt-2
                                                .row.ml-auto.mr-auto
                                                    .align-self-center
                                                        span.mr-2 Step:
                                                        a.text-warning.align-self-end.alert-btn(title="Step Range 8" href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:8']]); return false;`).mr-1 8
                                                        a.text-warning.align-self-end.alert-btn(title="Step Range 16" href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:16']]); return false;`).mr-1 16
                                                        a.text-warning.align-self-end.alert-btn(title="Step Range 24" href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:24']]); return false;`).mr-1 24
                                                        a.text-warning.align-self-end.alert-btn(title="Step Range 32" href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:32']]); return false;`).mr-1 32
                                                        a.text-warning.align-self-end.alert-btn(title="Step Range 48" href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:48']]); return false;`).mr-1 48
                                                        a.text-warning.align-self-end.alert-btn(title="Step Range 64" href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:64']]); return false;`).mr-1 64
                                                    div.d-inline.mt-sm-0.mt-1
                                                        span.d-none.d-sm-inline.mr-2 Emphasis:
                                                        a.align-self-end.alert-btn(href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:${colorStep}:0']]); return false;` style='background-color: red; border-color: #770e0eab; color: #770000;').mr-1
                                                            i.fas.fa-eye-dropper
                                                        a.align-self-end.alert-btn(href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:${colorStep}:1']]); return false;` style='background-color: rgb(255 128 0); border-color: #77360eab; color: #773700;').mr-1
                                                            i.fas.fa-eye-dropper
                                                        a.align-self-end.alert-btn(href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:${colorStep}:2']]); return false;` style='background-color: rgb(255 255 0); border-color: #775c0eab; color: #776300;').mr-1
                                                            i.fas.fa-eye-dropper
                                                        a.align-self-end.alert-btn(href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:${colorStep}:3']]); return false;` style='background-color: rgb(0 255 0); border-color: #27770eab; color: #447700;').mr-1
                                                            i.fas.fa-eye-dropper
                                                        a.align-self-end.alert-btn(href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:${colorStep}:4']]); return false;` style='background-color: rgb(128 255 128); border-color: #27770eab; color: #447700;').mr-1
                                                            i.fas.fa-eye-dropper
                                                    div.d-inline.mt-sm-0.mt-1
                                                        a.align-self-end.alert-btn(href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:${colorStep}:5']]); return false;` style='background-color: rgb(14 210 206); border-color: #0d5246ab; color: #007b65;').mr-1
                                                            i.fas.fa-eye-dropper
                                                        a.align-self-end.alert-btn(href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:${colorStep}:6']]); return false;` style='background-color: rgb(0 142 255); border-color: #0e4b77ab; color: #004b77;').mr-1
                                                            i.fas.fa-eye-dropper
                                                        a.align-self-end.alert-btn(href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:${colorStep}:7']]); return false;` style='background-color: rgb(0 60 255); border-color: #5662ffdb; color: #597dff;').mr-1
                                                            i.fas.fa-eye-dropper
                                                        a.align-self-end.alert-btn(href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:${colorStep}:8']]); return false;` style='background-color: rgb(128 0 255); border-color: #4b0e77ab; color: #440077;').mr-1
                                                            i.fas.fa-eye-dropper
                                                        a.align-self-end.alert-btn(href='#_' onclick=`getNewContent(['offset'], [['color', '${simularColorCommand}:${colorStep}:9']]); return false;` style='background-color: rgb(255 0 255); border-color: #790048db; color: #880a8a;').mr-1
                                                            i.fas.fa-eye-dropper
                                if (nsfwEnabled || nsfwContent || (params && params.getAll('nsfw')[0] === 'true'))
                                    .alert.alert-danger-transparent(role="alert")
                                        .row
                                            .col-auto.align-self-start.align-self-center
                                                .glyphicon
                                                    i.fas.fa-exclamation-triangle.text-danger
                                            if (nsfwEnabled)
                                                .align-self-start.align-self-center
                                                    .text-danger NSFW Content is Enabled
                                                .align-self-center.align-self-start.ml-auto.mr-1
                                                    a.text-danger.align-self-end.alert-btn(title="Disable NSFW Results" href='#_' onclick=`getNewContent(['offset', 'nsfw'], [['nsfwEnable', 'false']]); return false;`) Disable
                                            else
                                                .align-self-start.align-self-center
                                                    .text-danger NSFW Results are included
                                                .align-self-center.align-self-start.ml-auto.mr-1
                                                    a.text-danger.align-self-end.alert-btn(title="Remove NSFW Results" href='#_' onclick=`getNewContent(['offset', 'nsfw'], []); return false;`) Remove
                        #reviewBtns.hidden.mb-3
                            div.d-sm-flex.align-items-center.d-inline
                                .col.p-0.d-flex.align-items-center
                                    h3
                                        i.fas.fa-check-to-slot.pr-2
                                        span#reviewDestinationName NaN
                                .col-auto.p-0.d-flex
                                    a.btn.btn-primary.mr-1.w-100(title="Setup Review Mode" href='#_' onclick='setupReviewMode(true); return false;')
                                        i.fas.fa-cog
                                    a.btn.btn-primary.ml-1.w-100(title="Leave Review Mode" href='#_' onclick='disableReviewMode(); return false;')
                                        i.fas.fa-times
                        #contentBlock.animated--grow-in
                            block content
                            script(type='text/javascript' src="/js/client/onload.min.js")
                        #pageinator
                if (!(params.has('responseType') && params.getAll('responseType')[0] === 'offline'))
                    #finalLoad
                        #pageNav.btn-group.d-block.page-navigator
                            // Next Page Button
                            if (params && ((((params.getAll('channel')[0] === 'random' || !(params.has('channel') || params.has('folder') || params.has('album') || params.has('album_name'))) && params.getAll('sort')[0] === 'random') || params.getAll('sort')[0] === 'random') && !search_prev))
                                a.bottomBtn.btn.btn-lg.btn-circle.red(title="Go Back" href='#_' role='button' accesskey="," onClick="history.go(-1); return false;")
                                    i.fa.fa-chevron-left
                                    i.fa.fa-arrow-left
                                a#nextPage.bottomBtn.btn.btn-lg.btn-circle.red(title="Reload Page" href='#_' onClick="getNewContent([],[['refresh','true']]); return false;")
                                    if (params && params.getAll('sort')[0] === 'random')
                                        i.fa.fa-dice
                                    else
                                        i.fa.fa-sync
                            else if ((typeof (prevurl) !== 'undefined' && prevurl !== 'NA') || (typeof (nexturl) !== 'undefined' && nexturl !== 'NA'))
                                if (prevurl !== 'NA')
                                    a.bottomBtn.btn.btn-lg.btn-circle.red(title="Go Back" href='#_' role='button' accesskey="," onClick="history.go(-1); return false;")
                                        i.fa.fa-chevron-left
                                        i.fa.fa-arrow-left
                                    a#prevPage.bottomBtn.btn.btn-lg.btn-circle.red(title="Previous Page" href='#_' onclick=`getNewContent([], [${prevurl}]); return false;`)
                                        i.fa.fa-arrow-left
                                else
                                    a.bottomBtn.btn.btn-lg.btn-circle.red(title="Go Back" href='#_' role='button' accesskey="," onClick="history.go(-1); return false;")
                                        i.fa.fa-chevron-left
                                        i.fa.fa-arrow-left
                                a#refreshPage.bottomBtn.btn.btn-lg.btn-circle.red(title="Refresh Page" href='#_' onClick=`getNewContent([], [['refresh','true']]); return false;`)
                                    i.fa.fa-sync
                                if (nexturl !== 'NA')
                                    a#nextPage.bottomBtn.btn.btn-lg.btn-circle.red(title="Next Page" href='#_' onclick=`getNewContent([], [${nexturl}]); return false;`)
                                        i.fa.fa-arrow-right
                            else
                                a.bottomBtn.btn.btn-lg.btn-circle.red(title="Go Back" href='#_' role='button' accesskey="," onClick="history.go(-1); return false;")
                                    i.fa.fa-chevron-left
                                    i.fa.fa-arrow-left
                                a#refreshPage.bottomBtn.btn.btn-lg.btn-circle.red(title="Refresh Page" href='#_' onClick="getNewContent([], [['refresh','true']]); return false;")
                                    i.fa.fa-sync
                            // On Load Scripts
                        script(type='text/javascript' src="/js/client/onload.min.js")
                        // Gallery Custom Buttons
                        //script.
                            $.fancybox.defaults.btnTpl.downloadios = '<button data-fancybox-downloadios class="fancybox-button fancybox-button-downloadios" title="Download Image">' +
                                '<i class="fas fa-download">' +
                                '</button>';
                            $('body').on('click', '[data-fancybox-downloadios]', function (e) {
                                const src = $.fancybox.getInstance().current.src;
                                const idx = $.fancybox.getInstance().current.opts.$orig;
                                $('#downloadModel').modal('show');
                                $('#downloadContainer')[0].src = src.replace('https:', 'http:')
                            });
                        // Sidebar Selector
                        if (!appData)
                            if (params && path === '/artists')
                                script.
                                    function setSidebar() {
                                        setAccordion("globalTags", "allArtists")
                                    }; setSidebar();
                            else if (params && params.has('search'))
                                script.
                                    function setSidebar() {
                                        setAccordion("searchPosts", null)
                                    }; setSidebar();
                            else if (params && params.has('displayname'))
                                script.
                                    function setSidebar() {
                                        setAccordion("historyPosts", null)
                                    }; setSidebar();
                            else if (params && (params.getAll('channel')[0] === 'random' || !(params.has('channel') || params.has('folder') || params.has('album') || params.has('album_name'))) && !(params.getAll('sort')[0] === 'random' || params.getAll('sort')[0] === 'id' || params.getAll('sort')[0] === 'eid' || params.getAll('sort')[0] === 'fav'))
                                if (params.has('color'))
                                    script.
                                        function setSidebar() {
                                            setAccordion("searchPosts", null)
                                        }; setSidebar();
                                else
                                    script.
                                        function setSidebar() {
                                            setAccordion("recentPosts", null)
                                        }; setSidebar();
                            else if (params && (params.getAll('channel')[0] === 'random' || !(params.has('channel') || params.has('folder') || params.has('album') || params.has('album_name'))) && params.getAll('sort')[0] === 'random')
                                if (params.has('color'))
                                    script.
                                        function setSidebar() {
                                            setAccordion("searchPosts", null)
                                        }; setSidebar();
                                else
                                    script.
                                        function setSidebar() {
                                            setAccordion("randomPosts", null)
                                        }; setSidebar();
                            else if (params && (params.getAll('channel')[0] === 'random' || !(params.has('channel') || params.has('folder') || params.has('album') || params.has('album_name'))) && params.getAll('sort')[0] === 'fav')
                                if (webconfig && webconfig.pinned_user && params.getAll('pins')[0] === webconfig.pinned_user)
                                    script.
                                        function setSidebar() {
                                            setAccordion("globalTags", "pinnedKazari")
                                        }; setSidebar();
                                else if (params.has('pins') && params.getAll('pins')[0] !== 'false')
                                    script.
                                        function setSidebar() {
                                            setAccordion("favoritePosts", null)
                                        }; setSidebar();
                            else if (params && (params.getAll('channel')[0] === 'random' || !(params.has('channel') || params.has('folder') || params.has('album') || params.has('album_name'))) && (params.getAll('sort')[0] === 'id' || params.getAll('sort')[0] === 'eid'))
                                if (webconfig && webconfig.pinned_user && params.getAll('pins')[0] === webconfig.pinned_user)
                                    script.
                                        function setSidebar() {
                                            setAccordion("pinnedPosts", null)
                                        }; setSidebar();
                                else if (params.has('pins') && params.getAll('pins')[0] !== 'false')
                                    script.
                                        function setSidebar() {
                                            setAccordion("favoritePosts", null)
                                        }; setSidebar();
                                else if (path === '/files')
                                    script.
                                        function setSidebar() {
                                            setAccordion("streamFiles")
                                        }; setSidebar();
                                else
                                    script.
                                        function setSidebar() {
                                            setAccordion("streamPictures")
                                        }; setSidebar();
                            else if (!params && !title)
                                script.
                                    function setSidebar() {
                                        setAccordion("searchPosts", null)
                                    }; setSidebar();
                            else if (params && params.has('album'))
                                - const albumID = params.getAll('album')[0]
                                script.
                                    function setSidebar() {
                                        setAccordion("albums", #{"'album-item-" + albumID + "'"})
                                    }; setSidebar();
                            else if (params && params.has('title') && active_pt)
                                script.
                                    function setSidebar() {
                                        setAccordion(#{"'" + active_pt.toLowerCase() + "'"}, #{"'all-" + active_pt.toLowerCase() + "'"})
                                    }; setSidebar();
                            else if (active_pt && active_ch)
                                script.
                                    function setSidebar() {
                                        setAccordion(#{"'" + active_pt.toLowerCase() + "'"}, #{"'" + active_ch + "'"})
                                    }; setSidebar();
                            else if (active_pt)
                                script.
                                    function setSidebar() {
                                        setAccordion(#{"'" + active_pt.toLowerCase() + "'"}, #{"'all-" + active_pt.toLowerCase() + "'"})
                                    }; setSidebar();
                            // Music Player Enabler
                            script(type='text/javascript' src="/js/client/media-enabler.min.js")
                    footer.sticky-footer.bg-transparent
                        .container.my-auto
                            .copyright.text-center.my-auto
                                div.mb-2
                                    span.sidebar-brand-logo.sequenzia-logo(class=showlogo1 style='font-size: 2.8em;') sequenzia
                                div
                                    strong The Kanmi x Sequenzia II Project
                                div
                                    span Copyright &copy; #{webconf.company_name} #{moment(Date.now()).format('YYYY')}
                            .server-grid-container.text-center.mt-3.hide-1700
                                .server-grid.d-inline-block
                                    .server-grid-parent(style=`grid-template-columns: repeat(${discord.servers.list.slice(0, 8).length}, minmax(45px, 40px));`)
                                        for thisServer, thisServerIndex in discord.servers.list.slice(0,8)
                                            .server-grid-child(style=`z-index: ${8 - thisServerIndex}`)
                                                img.server-icon.rounded-circle(title=`${thisServer.name}\n(${(thisServer.login === 1) ? 'Login Server' : 'Storage'})` src=thisServer.icon id=`server-${thisServer.serverid}`)
                    if (!appData)
                        #downloadAll.modal.fade(tabindex='-1' role='dialog' aria-hidden='true')
                            .modal-dialog(role='document')
                                .modal-content
                                    .modal-header
                                        h5.modal-title
                                            i.fas.fa-download.pr-2
                                            | Downloader
                                        button.close.text-white(type='button' data-dismiss='modal' aria-label='Close')
                                            span(aria-hidden='true') &times;
                                    .modal-body
                                        div.row.pl-3.pr-3
                                            h4#downloadProgText.small.font-weight-bold Ready
                                        div.row.pl-3.pr-3
                                            div.col.pl-1
                                                .progress(style="height: 30px;")
                                                    #downloadProgressBar.progress-bar.progress-bar-striped.progress-bar-animated.bg-success(role='progressbar' style='width: 0%' aria-valuenow='0' aria-valuemin='0' aria-valuemax='100')
                                            div
                                                a#downloadStartButton.btn.btn-success(title="Start Downloading all items on this page" href='#_' onclick=`startDownloadingFiles(); return false;`, role='button')
                                                    i.fas.pr-2.fa-download
                                                    | Start
                                                a#downloadStopButton.btn.btn-danger.hidden(title="Stop current and pending downloads" href='#_' onclick=`downloadAllController.ready = false; downloadAllController.about.about(); return false;`, role='button')
                                                    i.fas.pr-2.fa-ban
                                                    | Cancel
                        #feedModel.modal.fade(tabindex='-1' role='dialog' aria-hidden='true')
                            .modal-dialog(role='document')
                                .modal-content
                                    .modal-header
                                        h5.modal-title
                                            i.fas.fa-square-rss.pr-2
                                            | External Feeds
                                        button.close.text-white(type='button' data-dismiss='modal' aria-label='Close')
                                            span(aria-hidden='true') &times;
                                    .modal-body
                                        div.row.pl-3.pr-3
                                            div.pr-2
                                                | Only Accessible items will be returned!
                                        if (params && path === '/files')
                                            div.row.pl-3.pr-3
                                                div.pr-2.d-flex
                                                    span.align-self-center Media Podcast:
                                                div
                                                    a.btn.btn-primary(title="iTunes Compatible Feed" href='#_' onclick=`feedContent('podcast'); return false;`, role='button')
                                                        i.fas.pr-2.fa-podcast
                                                        | Podcast
                                        div.row.pl-3.pr-3.pt-2
                                            div.pr-2.d-flex
                                                span.align-self-center Content Feed:
                                            div
                                                a.btn.btn-primary(title="Atom Standard Feed" href='#_' onclick=`feedContent('atom'); return false;`, role='button').mr-2
                                                    i.fas.fa-square-rss.pr-2
                                                    | Atom
                                                a.btn.btn-primary(title="XML Standard Feed" href='#_' onclick=`feedContent('xml'); return false;`, role='button').mr-2
                                                    i.fas.fa-square-rss.pr-2
                                                    | XML
                                                a.btn.btn-primary(title="JSON Standard Feed" href='#_' onclick=`feedContent('json'); return false;`, role='button')
                                                    i.fas.fa-square-rss.pr-2
                                                    | JSON
                                        #feedURLdiv.row.pl-3.pr-3.pt-2.d-none
                                            input#feedURLholder(type='text').form-control.form-text
                                        #feedNoKeydiv.row.pl-3.pr-3.pt-2.d-none
                                            p.text-danger You currently do not have a static login token!
                                            p Go to the user menu > Authentication > Regenerate, Then refresh and try again.

                        #searchModal.modal.fade(tabindex='-1' role='dialog' aria-hidden='true')
                            .modal-dialog(role='document')
                                .modal-content
                                    .modal-body(style='z-index: 1; overflow: clip;').pt-2
                                        div.row.px-3
                                            div#authorData.mt-1.w-100.d-flex.flex-row.align-items-start
                                                img(style='height: 48px;').rounded-circle.pr-2.shadow-blk
                                                span(style='font-size: 1.5em;').text-ellipsis.align-self-center.shadow-text
                                                button.close.text-white(type='button' data-dismiss='modal' aria-label='Close').align-self-center.shadow-text.ml-auto
                                                    span(aria-hidden='true') &times;
                                        div.row.px-2.flex-nowrap.mb-1.mt-2(style='display: flex; justify-content: space-evenly; align-content: center; flex-direction: row; align-items: center;')
                                            a#toggleFavoritePost.btn.text-white(role="button" href='#_' class=`${(login_source && login_source >= 900) ? 'hidden' : ''}`)
                                                i.fas.fa-star.shadow-text
                                            a#manageAlbumPost.btn.text-white(role="button" href='#_' class=`${(login_source && login_source >= 900) ? 'hidden' : ''}`)
                                                i.fas.fa-archive.shadow-text
                                            a#addFlagPost.btn.text-white(role="button" href='#_' class=`${(login_source && login_source >= 900) ? 'hidden' : ''}`)
                                                i.fas.fa-flag.shadow-text
                                            a#goToPostLocation.btn.text-white(href='#_' role='button')
                                                i.fas.fa-directions.shadow-text
                                            a#goToPostSource.btn.text-white(href='#_' role='button').hidden
                                                i.fas.fa-link.shadow-text
                                            a#goToHistoryDisplay.btn.text-white(href='#_' role='button')
                                                i.fas.fa-history.shadow-text
                                            a#goToPlay.btn.text-white(href='#_' role='button')
                                                i.fas.fa-play.shadow-text
                                            a#goToDownload.btn.text-white(href='#_' role='button' target="_blank" rel="noopener noreferrer")
                                                i.fas.fa-download.shadow-text
                                            a#makeOffline.btn.text-white(href='#_' role='button')
                                                i.fas.fa-bookmark.shadow-text
                                        #keepExpireingFile.row.pl-3.pr-3.hidden
                                            a.btn.btn-primary(data-toggle='collapse' href='#_' role='button').mb-2.w-100
                                                i.fas.fa-clock.pr-2
                                                span Keep Offline File
                                        div.row.px-3
                                            div#kmsContent.mb-2.text-center.w-100
                                                div.d-flex
                                                    div.mr-2
                                                        img#kmsInfoPoster
                                                    div.d-flex.flex-column.text-ellipsis.w-100
                                                        div
                                                            span.episode-number#kmsInfoNumber
                                                        span#kmsInfoShowName.font-weight-bold.text-ellipsis.text-left
                                                        span#kmsInfoEpisodeName.text-ellipsis.text-left
                                                div.mt-2
                                                    span#kmsInfoEpisodeDescription
                                        div.row.px-3
                                            span#infoFilename.text-center.w-100.font-italic.text-lg.shadow-text
                                        div.row.px-3
                                            div#rawInfoContent.mt-2.text-center.w-100
                                        div.row.px-3.mb-2
                                            div#rawBodyContent.mt-1.text-center.w-100
                                                div.card-ui(style='max-height: 200px; overflow-x: hidden; overflow-y: auto; overflow-wrap: anywhere')
                                        #findMenus.accordion.row.pl-3.pr-3.mt-2
                                            div#tagsHeader.w-100
                                                #tagHeader
                                                    h3.mb-0
                                                        button.btn.btn-link(type='button' data-toggle='collapse' data-target='#tagCollapse')
                                                            i.fas.pr-2.fa-tags
                                                            | Tags
                                                            i.fas.fa-chevron-right.pl-2
                                                #tagCollapse.collapse.show(data-parent='#findMenus').w-100
                                                    div.mt-1
                                                        div#tagsHolder.d-flex.flex-wrap.justify-content-center(style="font-size: 1.2em;")
                                                        div
                                                            span.text-success.text-xs Powered by Mugino MIITS
                                                    div#tagLocationSelection.btn-group.btn-group-toggle.mt-2.w-100(data-toggle='buttons')
                                                        label#tagFilterPost.btn.btn-info.w-100
                                                            input(type='radio' name='options' autocomplete='off' data-search-location='' checked='')
                                                            span  Post
                                                        label#tagFilterCurrent.btn.btn-info.w-100.active
                                                            input(type='radio' name='options' autocomplete='off' data-search-location='')
                                                            span  Session
                                                        label#tagFilterEverywhere.btn.btn-info.w-100
                                                            input(type='radio' name='options' autocomplete='off' data-search-location='')
                                                            span  Everywhere
                                            div.w-100
                                                #searchHeader
                                                    h3.mb-0
                                                        button.btn.btn-link(type='button' data-toggle='collapse' data-target='#searchCollapse')
                                                            i.fas.pr-2.fa-search
                                                            | Search
                                                            i.fas.fa-chevron-right.pl-2
                                                #searchCollapse.collapse(data-parent='#findMenus').w-100
                                                    div.mt-1
                                                        a#searchUseChannel.btn.btn-primary(data-toggle='collapse' href='#_' role='button').mb-2.w-100.hidden
                                                            i.fas.fa-folder.pr-2
                                                            span Use Channel
                                                    div.mt-1
                                                        a#searchByParent.btn.btn-primary(data-toggle='collapse' href='#_' role='button').mb-2.w-100.hidden
                                                            i.fas.fa-level-up-alt.pr-2
                                                            span Parent Post
                                                        a#searchByUser.btn.btn-primary(data-toggle='collapse' href='#_' role='button').mb-2.w-100.hidden
                                                            i.fas.fa-user.pr-2
                                                            span Artist
                                                        a#searchByColor.btn.btn-primary(data-toggle='collapse' href='#_' role='button').mb-2.w-100.hidden
                                                            i.fas.fa-swatchbook.pr-2
                                                            span Similar Color
                                                        a#searchByID.btn.btn-primary(data-toggle='collapse' href='#_' role='button').mb-2.w-100.hidden
                                                            i.fas.fa-asterisk.pr-2
                                                            span Related IDs
                                                        a#searchSelectedText.btn.btn-primary(data-toggle='collapse' href='#_' role='button').mb-2.w-100
                                                            i.fas.fa-i-cursor.pr-2
                                                            span Selected Text
                                                    div#searchLocationSelection.btn-group.btn-group-toggle.mt-2.w-100(data-toggle='buttons')
                                                        label#searchFilterPost.btn.btn-info.w-100
                                                            input(type='radio' name='options' autocomplete='off' data-search-location='' checked='')
                                                            span  Post
                                                        label#searchFilterCurrent.btn.btn-info.w-100.active
                                                            input(type='radio' name='options' autocomplete='off' data-search-location='')
                                                            span  Session
                                                        label#searchFilterEverywhere.btn.btn-info.w-100
                                                            input(type='radio' name='options' autocomplete='off' data-search-location='')
                                                            span  Everywhere
                                            div.w-100
                                                #customizeHeader
                                                    h3.mb-0
                                                        button.btn.btn-link(type='button' data-toggle='collapse' data-target='#customizeCollapse')
                                                            i.fas.pr-2.fa-swatchbook
                                                            | Customize
                                                            i.fas.fa-chevron-right.pl-2
                                                #customizeCollapse.collapse(data-parent='#findMenus').w-100
                                                    div.mt-1
                                                        a#setAsAvatar.btn.btn-primary(data-toggle='collapse' href='#_' role='button').mb-2.w-100
                                                            i.fas.fa-crop-alt.pr-2
                                                            span Set as Avatar
                                                        a#setAsBanner.btn.btn-primary(data-toggle='collapse' href='#_' role='button').mb-2.w-100
                                                            i.fas.fa-crop-alt.pr-2
                                                            span Set as Banner
                                            div#manageButtons.w-100
                                                #toolboxHeader
                                                    h3.mb-0
                                                        button.btn.btn-link(type='button' data-toggle='collapse' data-target='#toolboxCollapse')
                                                            i.fas.pr-2.fa-toolbox
                                                            | Manage
                                                            i.fas.fa-chevron-right.pl-2
                                                #toolboxCollapse.collapse(data-parent='#findMenus').w-100.px-2
                                                    .row.flex-nowrap.mt-1
                                                        a#infoMove.btn.btn-danger.mx-1.mb-2(title="Move Item" href='#_').w-100.text-ellipsis
                                                            i.fas.fa-cut.pr-0.pr-sm-2
                                                            span.d-none.d-sm-inline Move
                                                        a#infoEditText.btn.btn-danger.mx-1.mb-2(title="Edit Item Contents" href='#_').w-100.text-ellipsis
                                                            i.fas.fa-square-quote.pr-0.pr-sm-2
                                                            span.d-none.d-sm-inline Edit
                                                        a#infoRename.btn.btn-danger.mx-1.mb-2(title="Rename Item" href='#_').w-100.text-ellipsis
                                                            i.fas.fa-input-text.pr-0.pr-sm-2
                                                            span.d-none.d-sm-inline Rename
                                                        a#infoRotae.btn.btn-danger.mx-1.mb-2(title="Rotate Image" href='#_').w-100.text-ellipsis
                                                            i.fas.fa-undo.pr-0.pr-sm-2
                                                            span.d-none.d-sm-inline Rotate
                                                    .row.flex-nowrap
                                                        a#infoRepair.btn.btn-danger.mx-1.mb-2(title="Repair Thumbnail" href='#_').w-100.text-ellipsis
                                                            i.fas.fa-image-slash.pr-0.pr-sm-2
                                                            span.d-none.d-sm-inline Thumb
                                                        a#infoCompile.btn.btn-danger.mx-1.mb-2(title="Compile Spanned File" href='#_').w-100.text-ellipsis
                                                            i.fas.fa-cloud-check.pr-0.pr-sm-2
                                                            span.d-none.d-sm-inline Cache
                                                        a#infoDecompile.btn.btn-danger.mx-1.mb-2(title="Remove Cached Spanned File" href='#_').w-100.text-ellipsis
                                                            i.fas.fa-cloud-xmark.pr-0.pr-sm-2
                                                            span.d-none.d-sm-inline DeCache
                                                        a#infoDelete.btn.btn-danger.mx-1.mb-2(title="Archive or Delete Item(s)" href='#_').w-100.text-ellipsis
                                                            i.fas.fa-trash.pr-0.pr-sm-2
                                                            span.d-none.d-sm-inline Delete
                                                        a#infoReport.btn.btn-danger.mx-1.mb-2(title="Clear Reported Item(s)" href='#_').w-100.text-ellipsis
                                                            i.fas.fa-flag.pr-0.pr-sm-2
                                                            span.d-none.d-sm-inline Clear
                                            div.w-100
                                                #debugHeader
                                                    h3.mb-0
                                                        button.btn.btn-link(type='button' data-toggle='collapse' data-target='#debugCollapse')
                                                            i.fas.pr-2.fa-info-circle
                                                            | Debug
                                                            i.fas.fa-chevron-right.pl-2
                                                #debugCollapse.collapse(data-parent='#findMenus').w-100
                                                    div.mt-1
                                                        div#advancedInfoBlock.text-center.w-100.d-flex.flex-column.flex-wrap.align-items-start
                                        .modal-background.blur-this
                                        .modal-gradient
                        #appModal.modal.fade(tabindex='-1' role='dialog' aria-hidden='true')
                            .modal-dialog.modal-dialog-scrollable.modal-sm(role='document')
                                .modal-content
                                    .modal-header
                                        h5.modal-title
                                            i.fas.fa-desktop.pr-2
                                            | Setup Wallpaper Services
                                        button.close.text-white(type='button' data-dismiss='modal' aria-label='Close')
                                            span(aria-hidden='true') &times;
                                    .modal-body
                                        div
                                            #iOSShortcutData.collapse
                                                .d-flex
                                                    span.text-center Copy and Paste into 'Text' before Run Shortcut 'Sequenzia Wallpaper Services'
                                                .d-flex
                                                    input#pageURIholder(type='text').form-control.form-text.w-100
                                            div.d-flex
                                                span.text-lg Both Wallpapers
                                            div.d-flex
                                                a.btn.btn-primary(href="seq://configure?setType=0&" + android_uri role='button' target="_blank" rel="noopener noreferrer").mr-1.w-100
                                                    i.fas.fa-file-import.pr-2
                                                    | Android
                                                a.btn.btn-primary(href='#_' role='button' onclick="generateShortcutURI('pageURIholder', 0); $('#iOSShortcutData').collapse('show'); return false;").ml-1.w-100
                                                    i.fas.fa-file-import.pr-2
                                                    | iOS/DWS
                                            div.d-flex
                                                span.text-lg Home Screen
                                            div.d-flex
                                                a.btn.btn-primary(href="seq://configure?setType=1&" + android_uri role='button' target="_blank" rel="noopener noreferrer").mr-1.w-100
                                                    i.fas.fa-file-import.pr-2
                                                    | Android
                                                a.btn.btn-primary(href='#_' role='button' onclick="generateShortcutURI('pageURIholder', 1); $('#iOSShortcutData').collapse('show'); return false;").ml-1.w-100
                                                    i.fas.fa-file-import.pr-2
                                                    | iOS/DWS
                                            div.d-flex
                                                span.text-lg Lock Screen
                                            div.d-flex
                                                a.btn.btn-primary(href="seq://configure?setType=2&" + android_uri role='button' target="_blank" rel="noopener noreferrer").mr-1.w-100
                                                    i.fas.fa-file-import.pr-2
                                                    | Android
                                                a.btn.btn-primary(href='#_' role='button' onclick="generateShortcutURI('pageURIholder', 2); $('#iOSShortcutData').collapse('show'); return false;").ml-1.w-100
                                                    i.fas.fa-file-import.pr-2
                                                    | iOS/DWS
                                        div.row.pl-3.pr-3.pt-2
                                            span.align-self-center Don't have the app?
                                        div.row.pl-3.pr-3.pt-2
                                            a.btn.btn-success(title="Android APK Download" href="/static/applications/ads-mobile-release.apk" role='button' target="_blank" rel="noopener noreferrer" download).mb-2.w-100
                                                i.fas.fa-download.pr-2
                                                | Android APK
                                        div.row.pl-3.pr-3
                                            a.btn.btn-success(title="Desktop Service Setup" href="https://www.npmjs.com/package/sequenzia-ads-micro" role='button' target="_blank" rel="noopener noreferrer" download).mb-2.w-100
                                                i.fas.fa-download.pr-2
                                                | Desktop Setup
                                        div.row.pl-3.pr-3
                                            a.btn.btn-info(data-toggle='collapse' href='#_' role='button' aria-expanded='false' data-target='#MacOSSetup').mb-2.w-100
                                                i.fas.fa-info-circle.pr-2
                                                | macOS Setup
                                        div.row.pl-3.pr-3
                                            a.btn.btn-info(data-toggle='collapse' href='#_' role='button' aria-expanded='false' data-target='#iOSShortcutSetup').mb-2.w-100
                                                i.fas.fa-info-circle.pr-2
                                                | Apple Shortcut
                                        #MacOSSetup.collapse
                                            div.row.pl-3.pr-3.pt-2
                                                a.btn.btn-success(href='https://apps.apple.com/us/app/plash/id1494023538?mt=12' role='button' target="_blank" rel="noopener noreferrer").mb-2.w-100
                                                    i.fas.fa-download.pr-2
                                                    | Plash (App Store)
                                            div.row.pl-3.pr-3.pt-2
                                                .col
                                                    .row
                                                        | 1. Install the "Plash" for macOS
                                                    .row
                                                        | 2. Click the menu bar icon
                                                    .row
                                                        | 3. Click "Add Website"
                                                    .row
                                                        | 4. Enter the ADS Lite URL with your displayname and other settings
                                                    .row
                                                        | 5. Set name to "Sequenzia ADS"
                                                    .row
                                                        | 6. Click "Add"
                                                    .row
                                                        | 7. Go to Settings and enable "Launch at Logon"
                                                    .row
                                                        | If text looks to large add this CSS rule (adjust as needed):
                                                    .row
                                                        | "body { font-size: 0.85rem!important; }"
                                        #iOSShortcutSetup.collapse
                                            div.row.pl-3.pr-3.pt-2
                                                a.btn.btn-success(href='https://www.icloud.com/shortcuts/41b037c5fcb34954b4bd95fff833adce' role='button' target="_blank" rel="noopener noreferrer").mb-2.w-100
                                                    i.fas.fa-download.pr-2
                                                    | Apple Wallpaper Services
                                            div.row.pl-3.pr-3.pt-2
                                                .col
                                                    .row
                                                        | 1. Install the "Sequenzia Wallpaper Services" Shortcut from above
                                                    .row
                                                        | 2. Paste your Static Login Key
                                                    .row
                                                        | 3. In the automations tab, Click [+], Select "Personal Automation", and choose a type (Typically Time of day)
                                            div.row.pl-3.pr-3.pt-2
                                                .col
                                                    .row
                                                        img(src="/static/img/ios-shortcut-1.jpg").img-fluid
                                                    .row
                                                        | 4. Add Action from Search: "Text"
                                                    .row
                                                        | 5. Add Action from Search: "Run Shortcut"
                                                    .row
                                                        | 6. Select "Sequenzia Wallpaper Services"
                                                    .row
                                                        | 7. Expand Show More, Verify that the "Text" has automatically been filled
                                                        span.text-info If you see "Choose Variable", tap it then 'Select Magic Variable", and Tap "Text" under the text block
                                                    .row
                                                        | 8. Copy the text from the "iOS" Button for the wallpaper
                                                    .row
                                                        | 9. Paste the text into the "Text" block
                                                    .row
                                                        | 10. Click Play to make sure it works
                                                    .row
                                                        img(src="/static/img/ios-shortcut-2.jpg").img-fluid
                                                    .row
                                                        | 11. Click Next
                                                    .row
                                                        | 12. Uncheck "Ask Before Running" and Accept the warning
                                                    .row
                                                        | 13. Click Done
                                                    .row
                                                        | 14. Reopen Automation, and Run the Shortcut and accept all privacy warnings
                                                    .row
                                                        img(src="/static/img/ios-shortcut-3.jpg").img-fluid
                                                    .row
                                                        | When your automation runs you will get a notification, the set wallpapers will appear in the Ambient Manager


        // OUTSUDE DYNAMIC CONTENT
