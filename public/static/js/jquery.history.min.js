(function($,undefined){var Public=function(url,replace,state){var event=$.Event(replace?"replace":"push");Public.context.trigger(event,[url,_type]);if(event.isDefaultPrevented())return Public;if(_type==="pathname"){if(_last!==url)if(replace)window.history.replaceState(state?state:{},null,_last=url);else window.history.pushState(state?state:{},null,_last=url)}else if(_type==="hash"){if(_last!==url){location.hash=_last=url;if(_ie67){if(!$("#jQueryHistory").length)throw new Error("jQuery."+publicName+".push: iframe not found.");if(_firstTime){_firstTime=0;_iframe.contentWindow.document.open().close();_iframe.contentWindow.location.hash="/"}_iframe.contentWindow.document.open().close();_iframe.contentWindow.location.hash=url}}}else{throw new Error("jQuery."+publicName+".push: the listening is not active.")}Public.context.trigger(replace?"replaced":"pushed",[url,_type]);return Public},publicName="history";Public.context=$({});$.each(["on","off","trigger"],function(index,method){Public[method]=function(){Public.context[method].apply(Public.context,arguments);return Public}});Public.push=Public;Public.type=function(){return _type};Public.url=function(_location){_location=_location||location;if(_type===null)throw new Error("jQuery."+publicName+".url: the listening has not started.");if(_type==="pathname")return _location.pathname+_location.search+_location.hash;if(_location.hash.length>1){spl=_location.href.split("#");spl.shift();spl=spl.join("#");return spl}return""};Public.listen=function(type,interval){Public.unlisten();var size=arguments.length;if(!size||type==="auto"){type=_pushState?"pathname":"hash";size=1}else if(type!=="pathname"&&type!=="hash"){throw new Error("jQuery."+publicName+".listen: type is not valid.")}if(type==="hash"){if(!_onhashchange&&size===1||interval===true){interval=Public.config.interval;size=2}if(size===2&&(isNaN(interval)||interval<1))throw new Error("jQuery."+publicName+".listen: interval delay is not valid.")}if((_type=type)==="pathname"){if(!_pushState)throw new Error("jQuery."+publicName+".listen: this browser has not support to pushState.");$(window).on("popstate.history",function(event){if(event.originalEvent&&event.originalEvent.state&&_last!==location.pathname)Public.trigger("change",[_last=Public.url(),"pathname"])});if(location.pathname.length>1)Public.trigger("load",[Public.url(),"pathname"])}else{if(_onhashchange&&!interval){$(window).on("hashchange.history",function(event){var hash=Public.url();if(_last!==hash)Public.trigger("change",[_last=hash,"hash"])})}else{if(_ie67===undefined)_ie67=Public.ieCondition("lte IE 7");if(_ie67){if(!(size=$("body")).length)throw new Error("jQuery."+publicName+".listen: document is not ready.");_iframe=$('<iframe id="jQueryHistory" style="display:none" src="javascript:void(0);" />').appendTo(size)[0];var win=_iframe.contentWindow;if(location.hash.length>1){win.document.open().close();win.location.hash="#"+Public.url()}_interval=setInterval(function(){if((_last="#"+Public.url())!=="#"+Public.url(win.location)){win.document.open().close();win.location.hash=_last;Public.trigger("change",[_last.substr(1),"hash"])}},interval)}else{_last=Public.url();_interval=setInterval(function(){var hash=Public.url();if(_last!==hash)Public.trigger("change",[_last=hash,"hash"])},interval)}}if(location.hash.length>1){Public.trigger("load",[Public.url(),"hash"])}}return Public};Public.unlisten=function(){_type=_last=_iframe=null;$(window).off("popstate.history hashchange.history");$("#jQueryHistory").remove();clearInterval(_interval);return Public};Public.getSupports=function(type){var result={},size=arguments.length,docmode;if(!size||type==="pushState")result.pushState="pushState"in window.history;if(!size||type==="replaceState")result.replaceState="replaceState"in window.history;if(!size||type==="onhashchange")result.onhashchange="onhashchange"in window&&((docmode=document.documentMode)===undefined||docmode>7);if(size)return result[type];return result};Public.ieCondition=function(input){var id=Math.random().toString(36).substring(2),name="_ie_condition_"+id,$msie,result;$msie=$("<span>\x3c!--[if "+$("<i/>").html(input).text()+']><script type="text/javascript">window.'+name+"=true;<\/script><![endif]--\x3e</span>").appendTo(document.body);result=window[name]===true;try{delete window[name]}catch(e){window[name]=undefined}$msie.remove();return result};Public.supports=Public.getSupports();Public.config={interval:100};var _pushState=Public.supports.pushState,_onhashchange=Public.supports.onhashchange,_ie67=Public.ieCondition("lte IE 7"),_type=null,_interval,_iframe,_firstTime=1,_last;$[publicName]=Public})(jQuery);